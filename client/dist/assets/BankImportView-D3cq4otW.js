import{_ as Pe,u as je,r as h,a as Z,E as qe,o as We,aM as He,b as k,d as Q,w as m,f as J,g as n,j as i,k as w,Q as x,m as j,i as F,N as $,M as ee,K as p,n as q,L as ue,q as Ge,Y as Ye,W as Xe,X as te,S as Ze,s as Je,t as $e}from"./index-CzvB3Xry.js";import{Q as et}from"./QBanner-B4lD3za2.js";import{Q as T,a as ae}from"./QInput-DDS2Gl1d.js";import{u as tt,Q as z}from"./use-quasar-OXbVvlBM.js";import{b as ne,c as oe}from"./QSelect-sxqXvIeA.js";import{Q as at}from"./QForm-D2LgQEW0.js";import{Q as nt}from"./QSpace-TdYVAnSS.js";import{Q as ot}from"./QDialog-DQzS5NCS.js";import{Q as st}from"./QPage-Bfa9833q.js";import{C as rt}from"./ClosePopup-BtqDtvPP.js";import{a as W}from"./axios-DnX1qazU.js";import{E as me}from"./jspdf.es.min-CnG_L15J.js";import{autoTable as ge}from"./jspdf.plugin.autotable-bUJAAMeG.js";const it={name:"AustrianBankImport",setup(){const u=tt();je();let g=null;const V=h(!1),o=h("other"),B=h({date:new Date().toISOString().split("T")[0],amount:0,transaction_type:"Ausgabe",category_id:null,description:"",payment_method:"Karte"}),N=h([]),l=h([]),S=h(!1),A=h(!1),E=h(""),I=h(null),D=h([]),y=h({min:0,max:5e3}),O=h("date_desc"),pe=[{label:"Einnahme",value:"Einnahme"},{label:"Ausgabe",value:"Ausgabe"}],he=[{label:"Datum (Neueste zuerst)",value:"date_desc"},{label:"Datum (Ã„lteste zuerst)",value:"date_asc"},{label:"Betrag (HÃ¶chste zuerst)",value:"amount_desc"},{label:"Betrag (Niedrigste zuerst)",value:"amount_asc"}],ye=Z(()=>l.value.map(e=>({label:e.name,value:e.id}))),R=h({totalIncome:0,totalExpenses:0,balance:0,categories:[]}),H=Z(()=>{var e;return((e=R.value)==null?void 0:e.categories)||[]}),se=h(!1),re=h(null),K=h([{id:"erste",name:"Erste Bank und Sparkassen",format:"Datum;Buchungstext;Betrag",instruction:'Im Online-Banking: "Kontoauszug exportieren" > "CSV Format" auswÃ¤hlen'},{id:"raiffeisen",name:"Raiffeisen Bank",format:"Buchungstag;Valuta;Buchungstext;Betrag",instruction:'Im Raiffeisen Online-Banking: "UmsÃ¤tze exportieren" > CSV'},{id:"bawag",name:"BAWAG PSK",format:"Buchungsdatum;Betrag;Verwendungszweck",instruction:'BAWAG Online-Banking: "Kontoauszug" > "Exportieren" > CSV'},{id:"volksbank",name:"Volksbanken",format:"Datum;Text;Soll;Haben",instruction:"Volksbank Online-Banking: UmsatzÃ¼bersicht exportieren"},{id:"other",name:"Andere Ã¶sterreichische Bank",format:"Datum;Beschreibung;Betrag",instruction:"CSV-Datei mit Datum, Beschreibung und Betrag hochladen"}]),_e=h([{label:"ðŸ’° Einnahme",value:"Einnahme"},{label:"ðŸ’¸ Ausgabe",value:"Ausgabe"}]),fe=h([{label:"ðŸ’³ Karte",value:"Karte"},{label:"ðŸ’µ Bar",value:"Bar"},{label:"ðŸ¦ Ãœberweisung",value:"Ãœberweisung"},{label:"ðŸ”„ Dauerauftrag",value:"Dauerauftrag"},{label:"ðŸ“± Online",value:"Online"},{label:"ðŸ¦ Bank",value:"Bank"}]),ve=h([{label:"ðŸ  Miete",amount:-850,category_id:2,transaction_type:"Ausgabe",description:"Monatsmiete",payment_method:"Ãœberweisung",color:"blue"},{label:"ðŸ›’ Einkauf",amount:-120,category_id:1,transaction_type:"Ausgabe",description:"Wocheneinkauf",payment_method:"Karte",color:"green"},{label:"ðŸ’¼ Gehalt",amount:2500,category_id:3,transaction_type:"Einnahme",description:"Monatsgehalt",payment_method:"Ãœberweisung",color:"positive"},{label:"ðŸš— Tanken",amount:-80,category_id:4,transaction_type:"Ausgabe",description:"TankfÃ¼llung",payment_method:"Karte",color:"orange"}]),P=()=>{const e=J.getToken();if(!e)return null;try{return Ze(e).id}catch{return null}},ie=W.create({baseURL:"http://localhost:3000"}),ce=()=>{const e=J.getToken();return e?{Authorization:`Bearer ${e}`}:{}},be=()=>{const e=P();if(!e){u.notify({type:"negative",message:"Bitte zuerst einloggen"});return}window.location.href=`http://localhost:3000/api/bank/link?userId=${e}`},le=async()=>{var e;try{if(!J.getToken()){V.value=!1;return}const a=await ie.get("/api/bank/status",{headers:ce()});V.value=!!((e=a.data)!=null&&e.connected)}catch{V.value=!1}},ke=async()=>{try{const e=await W.get("http://localhost:3000/categories");l.value=e.data}catch(e){console.error("Error fetching categories:",e)}},we=e=>{const t=K.value.find(a=>a.id===e);return t?t.name:"Unbekannte Bank"},Ce=e=>{const t=K.value.find(a=>a.id===e);return t?t.instruction:"CSV-Datei mit Transaktionen hochladen"},xe=e=>{const t=K.value.find(a=>a.id===e);return t?t.format:"Datum;Beschreibung;Betrag"},M=e=>{const t=l.value.find(a=>a.id===e);return t?t.name:"Unkategorisiert"},G=Z(()=>{let e=[...N.value];if(E.value){const t=E.value.toLowerCase();e=e.filter(a=>{var r;return((r=a.description)==null?void 0:r.toLowerCase().includes(t))||M(a.category_id).toLowerCase().includes(t)})}switch(I.value&&(e=e.filter(t=>t.transaction_type===I.value)),D.value.length>0&&(e=e.filter(t=>D.value.includes(t.category_id))),e=e.filter(t=>t.amount>=y.value.min&&t.amount<=y.value.max),O.value){case"date_asc":e.sort((t,a)=>new Date(t.date)-new Date(a.date));break;case"date_desc":e.sort((t,a)=>new Date(a.date)-new Date(t.date));break;case"amount_asc":e.sort((t,a)=>t.amount-a.amount);break;case"amount_desc":e.sort((t,a)=>a.amount-t.amount);break}return e}),Y=()=>{const e=G.value,t={totalIncome:0,totalExpenses:0,balance:0,categories:[]};if(!e||e.length===0){R.value=t;return}const a=new Map;e.forEach(r=>{if(!r.amount||isNaN(r.amount)){console.warn("Skipping transaction with invalid amount:",r);return}const s=r.category_id,c=M(s);a.has(s)||a.set(s,{id:s,name:c,income:0,expenses:0,netAmount:0,transactionCount:0,transactions:[]});const d=a.get(s);r.transaction_type==="Einnahme"?(d.income+=Number(r.amount),t.totalIncome+=Number(r.amount)):(d.expenses+=Number(r.amount),t.totalExpenses+=Number(r.amount)),d.netAmount=d.income-d.expenses,d.transactionCount++,d.transactions.push(r)}),t.categories=Array.from(a.values()).sort((r,s)=>Math.abs(s.netAmount)-Math.abs(r.netAmount)),t.balance=t.totalIncome-t.totalExpenses,R.value=t};qe([E,I,D,y,O],()=>{Y()});const Be=e=>{if(!e||e.length===0)return;const t=e[0];if(t.size>5*1024*1024){u.notify({type:"negative",message:"Datei zu groÃŸ. Maximal 5MB erlaubt.",timeout:5e3});return}const a=new FileReader;a.onload=async r=>{A.value=!0;try{let s=r.target.result;const c=Se(s,o.value);if(c.length===0){u.notify({type:"warning",message:"Keine gÃ¼ltigen Transaktionen in der CSV-Datei gefunden.",timeout:5e3});return}const d=c.filter(_=>_.transaction_type==="Einnahme").reduce((_,L)=>_+Number(L.amount),0),v=c.filter(_=>_.transaction_type==="Ausgabe").reduce((_,L)=>_+Number(L.amount),0);let C=0,b=0;for(const _ of c)try{await Te(_),C++}catch(L){console.error("Error saving transaction:",L),b++}u.notify({type:C>0?"positive":"warning",message:`${C} Transaktionen importiert (Einnahmen: ${X(d)}, Ausgaben: ${X(v)})${b>0?`, ${b} Fehler`:""}`,timeout:6e3}),U()}catch(s){console.error("Error parsing CSV:",s),u.notify({type:"negative",message:"Fehler beim Import der CSV-Datei. Bitte Format Ã¼berprÃ¼fen.",timeout:5e3})}finally{A.value=!1}},a.readAsText(t,"UTF-8")},Se=(e,t)=>{const a=e.split(`
`).filter(s=>s.trim()),r=[];for(let s=0;s<a.length;s++)try{if(s===0&&a[s].toLowerCase().includes("datum")&&a[s].toLowerCase().includes("betrag"))continue;let c=a[s].trim();c.startsWith('"')&&c.endsWith('"')&&(c=c.slice(1,-1));const d=[];let v="",C=!1;for(let b of c)b==='"'?C=!C:b===";"&&!C?(d.push(v.trim()),v=""):v+=b;if(d.push(v.trim()),d.length>=3){const b=Ie(d,t,!0);if(b!==0){const _={date:Ee(d[0],t),amount:Math.abs(b),description:de(d,t),transaction_type:b>0?"Einnahme":"Ausgabe",category_id:De(de(d,t)),payment_method:"Bank",currency:"EUR"};_.date&&_.amount>0&&_.description&&r.push(_)}}}catch(c){console.warn("Skipping invalid CSV line:",a[s],c)}return r},Ee=(e,t)=>{if(!e)return null;if(e=e.replace(/"/g,""),e.includes(".")){const a=e.split(".");if(a.length===3){const[r,s,c]=a.map(v=>v.trim());return`${c.length===2?`20${c}`:c}-${s.padStart(2,"0")}-${r.padStart(2,"0")}`}}return e.match(/^\d{4}-\d{2}-\d{2}$/)?e:null},Ie=(e,t,a=!1)=>{for(let r=e.length-1;r>=0;r--){let s=e[r];if(!s||(s=s.replace(/"/g,"").trim(),!s.match(/\d/)))continue;let c=s.startsWith("-")||s.includes(" -")||s.toLowerCase().includes("soll"),d=s.replace(/[â‚¬$]/g,"").replace(/\s/g,"");d.match(/^\d{1,3}(\.\d{3})*,\d{2}$/)?d=d.replace(/\./g,"").replace(",","."):d.match(/^\d+,\d{2}$/)?d=d.replace(",","."):d.match(/^\d+(\.\d+)?$/),d=d.replace(/[^\d.-]/g,"");const v=Number(d);if(isNaN(v)||v===0)continue;const C=c?-Math.abs(v):Math.abs(v);return a?C:Math.abs(C)}return 0},de=(e,t)=>{const a=[];for(let r=1;r<e.length-1;r++)if(e[r]&&e[r].trim()){const s=e[r].replace(/"/g,"").trim();!s.match(/^-?\d+([.,]\d+)?$/)&&!s.match(/^\d{1,2}\.\d{1,2}\.\d{2,4}$/)&&s.length>1&&a.push(s)}if(a.length>0)return a.reduce((s,c)=>c.length>s.length?c:s,"").substring(0,100);for(let r=1;r<e.length;r++)if(e[r]&&e[r].trim()){const s=e[r].replace(/"/g,"").trim();if(!s.match(/^-?\d+([.,]\d+)?$/))return s.substring(0,100)||"Banktransaktion"}return"Banktransaktion"},De=e=>{const t=e.toLowerCase(),a=[{keywords:["billa","spar","hofer","lidl","merkur","mpreis","interspar","penny","unimarkt","dm ","bipa"],category_id:1},{keywords:["miete","wohnung","hausverwaltung","immobilie","hausgeld","wohnbau","genossenschaft"],category_id:2},{keywords:["gehalt","lohn","entgelt","salary","payroll","arbeitsentgelt"],category_id:3},{keywords:["tank","omv","shell","jet","aral","bp","agip","avanti","eneco","tankstelle"],category_id:4},{keywords:["restaurant","gasthaus","wirtshaus","cafe","bÃ¤ckerei","mcdonalds","burger","pizza","dÃ¶ner","kebab"],category_id:5},{keywords:["energie","strom","wien energie","kelag","verbund","evn","linz strom","gas","fernwÃ¤rme"],category_id:6},{keywords:["handy","a1","drei","telekom","t-mobile","mobilkom","hot","yesss","telefon","internet"],category_id:7},{keywords:["apotheke","arzt","krankenhaus","doktor","praxis","spital","pharmacy","medizin"],category_id:8},{keywords:["kino","theater","konzert","festival","museum","ausstellung","kino","film"],category_id:9},{keywords:["h&m","c&a","mango","zara","kik","peek","cloppenburg","kleidung","mode","bekleidung"],category_id:10}];for(const r of a)if(r.keywords.some(s=>t.includes(s)))return r.category_id;return 9},Te=async e=>{const t=P();if(!t)throw new Error("User not authenticated");const a={userId:t,categoryId:e.category_id,amount:Number(e.amount),transactionType:e.transaction_type,currency:e.currency,date:e.date+"T00:00:00",description:e.description};return(await W.post("http://localhost:3000/transactions",a)).data},Ve=async()=>{var t,a;const e=P();if(!e){u.notify({type:"negative",message:"Bitte einloggen um Transaktionen zu speichern"});return}S.value=!0;try{const r={userId:e,categoryId:B.value.category_id,amount:Math.abs(Number(B.value.amount)),transactionType:B.value.transaction_type,currency:"EUR",date:B.value.date+"T00:00:00",description:B.value.description};await W.post("http://localhost:3000/transactions",r),u.notify({type:"positive",message:"Transaktion erfolgreich gespeichert",icon:"check"}),B.value={date:new Date().toISOString().split("T")[0],amount:0,transaction_type:"Ausgabe",category_id:null,description:"",payment_method:"Karte"},U()}catch(r){console.error("Error adding transaction:",r),u.notify({type:"negative",message:"Fehler beim Speichern der Transaktion: "+(((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message)})}finally{S.value=!1}},Ae=e=>{B.value={date:new Date().toISOString().split("T")[0],amount:Math.abs(e.amount),transaction_type:e.transaction_type,category_id:e.category_id,description:e.description,payment_method:e.payment_method}},U=async()=>{const e=P();if(e)try{const t=await ie.get(`/api/bank/users/${e}?limit=100&sync=true`,{headers:ce()});N.value=t.data.map(a=>({...a,amount:Number(a.amount)||0,date:a.date.split("T")[0]})),Y()}catch(t){console.error("Error fetching transactions:",t),N.value=[],Y()}},Fe=()=>{E.value="",I.value=null,D.value=[],y.value={min:0,max:5e3},O.value="date_desc"},ze=e=>{re.value=e,se.value=!0},Ne=()=>{try{const e=["Datum","Beschreibung","Kategorie","Typ","Betrag"],t=G.value.map(c=>({date:c.date,description:c.description,category:M(c.category_id),type:c.transaction_type==="Einnahme"?"Einnahme":"Ausgabe",amount:`${c.transaction_type==="Einnahme"?"+":"-"}${c.amount} ${c.currency||"â‚¬"}`}));let a=e.join(";")+`
`;t.forEach(c=>{a+=Object.values(c).map(d=>`"${d}"`).join(";")+`
`});const r=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(r),s.download=`transaktionen_${new Date().toISOString().slice(0,10)}.csv`,s.click(),u.notify({type:"positive",message:"CSV erfolgreich exportiert"})}catch(e){console.error(e),u.notify({type:"negative",message:"Fehler beim CSV-Export"})}},Me=()=>{try{const e=new me;e.text("Transaktionsbericht",105,20,{align:"center"});const t=G.value.map(a=>[a.date,a.description||"Keine Beschreibung",M(a.category_id),a.transaction_type==="Einnahme"?"Einnahme":"Ausgabe",`${a.amount} ${a.currency||"â‚¬"}`]);ge(e,{head:[["Datum","Beschreibung","Kategorie","Typ","Betrag"]],body:t,startY:30}),e.save(`transaktionen_${new Date().toISOString().slice(0,10)}.pdf`),u.notify({type:"positive",message:"PDF-Bericht erfolgreich generiert"})}catch(e){console.error(e),u.notify({type:"negative",message:"Fehler beim PDF-Export"})}},Ue=()=>{try{const e=["Kategorie","Einnahmen","Ausgaben","Saldo"],t=H.value.map(c=>({category:c.name,income:c.income.toFixed(2),expenses:c.expenses.toFixed(2),balance:(c.income-c.expenses).toFixed(2)}));let a=e.join(";")+`
`;t.forEach(c=>{a+=Object.values(c).map(d=>`"${d}"`).join(";")+`
`});const r=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(r),s.download=`kategorie_bericht_${new Date().toISOString().slice(0,10)}.csv`,s.click(),u.notify({type:"positive",message:"CSV erfolgreich exportiert"})}catch(e){console.error(e),u.notify({type:"negative",message:"Fehler beim CSV-Export"})}},Le=()=>{try{const e=new me;e.text("Kategorie-Zusammenfassung",105,20,{align:"center"});const t=H.value.map(a=>[a.name,a.income.toFixed(2),a.expenses.toFixed(2),(a.income-a.expenses).toFixed(2)]);ge(e,{head:[["Kategorie","Einnahmen","Ausgaben","Saldo"]],body:t,startY:30}),e.save(`kategorie_bericht_${new Date().toISOString().slice(0,10)}.pdf`),u.notify({type:"positive",message:"PDF-Bericht erfolgreich generiert"})}catch(e){console.error(e),u.notify({type:"negative",message:"Fehler beim PDF-Export"})}},Qe=e=>new Date(e).toLocaleDateString("de-AT"),X=e=>e==null||isNaN(e)?"0,00":new Intl.NumberFormat("de-AT",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),Oe=e=>{let t="";switch(e){case"erste":t=`"Datum";"Buchungstext";"Betrag"
"30.09.2025";"MPREIS FILIALE 1234 WIEN";"-45,67"
"29.09.2025";"GEHALT FIRMA GMBH";"2450,00"`;break;case"raiffeisen":t=`"Buchungstag";"Valuta";"Buchungstext";"Betrag"
"30.09.2025";"30.09.2025";"TANKE SPAR 1234";"-78,90"`;break;case"bawag":t=`"Buchungsdatum";"Betrag";"Verwendungszweck"
"30.09.2025";"-120,50";"BILLA EINKAUF 1234"`;break;case"volksbank":t=`"Datum";"Text";"Soll";"Haben"
"30.09.2025";"ONLINE SHOPPING";"89,99";""`;break;default:t=`"Datum";"Beschreibung";"Betrag"
"30.09.2025";"Beispiel Transaktion";"-99,99"`}const a=new Blob([t],{type:"text/csv;charset=utf-8"}),r=window.URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download=`beispiel_${e}.csv`,s.click(),window.URL.revokeObjectURL(r)},Re=()=>{u.dark.set(!u.dark.isActive)},Ke=()=>{g&&clearInterval(g),g=setInterval(()=>{V.value&&U()},6e4)};return We(async()=>{await ke(),await le(),await U(),Ke()}),He(()=>{g&&clearInterval(g)}),{selectedBank:o,manualTransaction:B,recentTransactions:N,categories:l,savingTransaction:S,importingCSV:A,categorySummary:R,categorySummaries:H,searchText:E,transactionType:I,selectedCategories:D,amountRange:y,sortOption:O,typeOptions:pe,sortOptions:he,categoryOptions:ye,showCategoryDialog:se,activeCategory:re,austrianBanks:K,transactionTypes:_e,paymentMethods:fe,quickTransactions:ve,handleFileUpload:Be,addManualTransaction:Ve,openQuickTransaction:Ae,getBankName:we,getBankInstructions:Ce,getBankFormat:xe,getCategoryName:M,formatDate:Qe,formatCurrency:X,downloadSampleCSV:Oe,resetFilters:Fe,openCategoryDialog:ze,exportCSV:Ne,exportPDF:Me,exportCategoryCSV:Ue,exportCategoryPDF:Le,toggleDarkMode:Re,connectBank:be,checkBankConnection:le,fetchRecentTransactions:U,bankConnected:V}}},f=u=>(Je("data-v-cc11aab7"),u=u(),$e(),u),ct={class:"bank-import-view"},lt={class:"dark-mode-toggle"},dt={class:"compact-header q-mb-lg"},ut={class:"header-content"},mt=f(()=>n("div",null,[n("h1",{class:"text-h4 text-weight-bold text-dark q-mb-xs"},"ðŸ¦ Bank Import"),n("p",{class:"text-subtitle1 text-grey-7"},"Import transactions from Austrian banks")],-1)),gt={class:"main-grid"},pt={class:"left-column"},ht={class:"section-header"},yt=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Bank Import",-1)),_t={class:"section-header"},ft=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Quick Actions",-1)),vt={class:"quick-grid"},bt={class:"section-header"},kt=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Export",-1)),wt={class:"export-grid"},Ct={class:"right-column"},xt={class:"section-header"},Bt=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Manual Entry",-1)),St={class:"form-grid"},Et={class:"form-actions"},It={class:"section-header"},Dt=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Category Summary",-1)),Tt={class:"summary-stats q-mb-md"},Vt={class:"stat-item income"},At={class:"stat-icon"},Ft={class:"stat-content"},zt={class:"stat-value text-positive"},Nt=f(()=>n("div",{class:"stat-label"},"Income",-1)),Mt={class:"stat-item expense"},Ut={class:"stat-icon"},Lt={class:"stat-content"},Qt={class:"stat-value text-negative"},Ot=f(()=>n("div",{class:"stat-label"},"Expenses",-1)),Rt={class:"stat-item balance"},Kt={class:"stat-icon"},Pt={class:"stat-content"},jt=f(()=>n("div",{class:"stat-label"},"Balance",-1)),qt={class:"categories-grid"},Wt=["onClick"],Ht={class:"category-header"},Gt={class:"category-name"},Yt={class:"transaction-count"},Xt={class:"category-amounts"},Zt={class:"amount income"},Jt={class:"amount expense"},$t={key:0,class:"empty-state"},ea=f(()=>n("div",null,"No category data available",-1)),ta=f(()=>n("div",{class:"text-caption"},"Import transactions to see summary",-1)),aa={class:"dialog-title"},na={class:"dialog-stats"},oa={class:"dialog-stat"},sa=f(()=>n("div",{class:"stat-label"},"Income",-1)),ra={class:"stat-value text-positive"},ia={class:"dialog-stat"},ca=f(()=>n("div",{class:"stat-label"},"Expenses",-1)),la={class:"stat-value text-negative"},da={class:"dialog-stat"},ua=f(()=>n("div",{class:"stat-label"},"Net",-1)),ma={key:0};function ga(u,g,V,o,B,N){return k(),Q(st,{class:"q-pa-lg bg-page responsive-page-padding"},{default:m(()=>[n("div",ct,[n("div",lt,[i(w,{round:"",color:u.$q.dark.isActive?"grey-9":"yellow-9",icon:u.$q.dark.isActive?"dark_mode":"light_mode",class:"toggle-btn",onClick:o.toggleDarkMode,size:"lg"},null,8,["color","icon","onClick"])]),n("div",dt,[n("div",ut,[i(w,{icon:"arrow_back",flat:"",round:"",dense:"",onClick:g[0]||(g[0]=l=>u.$router.back()),class:"q-mr-sm"}),mt]),i(w,{icon:"refresh",flat:"",round:"",dense:"",onClick:o.fetchRecentTransactions},null,8,["onClick"])]),n("div",gt,[n("div",pt,[i(z,{class:"compact-card"},{default:m(()=>[i(T,{class:"card-section"},{default:m(()=>[n("div",ht,[i(x,{name:"account_balance",size:"20px",class:"text-primary"}),yt]),o.bankConnected?(k(),Q(et,{key:1,dense:"",rounded:"",class:"bg-positive text-white q-mb-md"},{default:m(()=>[j(" âœ… Bank erfolgreich verbunden ")]),_:1})):(k(),Q(w,{key:0,color:"primary",icon:"account_balance",label:"Bank verbinden (Online)",class:"q-mb-md full-width",onClick:o.connectBank},null,8,["onClick"]))]),_:1})]),_:1}),i(z,{class:"compact-card"},{default:m(()=>[i(T,{class:"card-section"},{default:m(()=>[n("div",_t,[i(x,{name:"bolt",size:"20px",class:"text-primary"}),ft]),n("div",vt,[(k(!0),F(ee,null,$(o.quickTransactions,l=>(k(),Q(w,{key:l.label,label:l.label,color:l.color,outline:"",size:"sm",onClick:S=>o.openQuickTransaction(l),class:"quick-btn"},null,8,["label","color","onClick"]))),128))])]),_:1})]),_:1}),i(z,{class:"compact-card"},{default:m(()=>[i(T,{class:"card-section"},{default:m(()=>[n("div",bt,[i(x,{name:"download",size:"20px",class:"text-primary"}),kt]),n("div",wt,[i(w,{color:"primary",icon:"picture_as_pdf",label:"PDF",onClick:o.exportPDF,outline:"",dense:"",class:"export-btn"},null,8,["onClick"]),i(w,{color:"positive",icon:"text_snippet",label:"CSV",onClick:o.exportCSV,outline:"",dense:"",class:"export-btn"},null,8,["onClick"]),i(w,{color:"secondary",icon:"pie_chart",label:"Categories PDF",onClick:o.exportCategoryPDF,outline:"",dense:"",class:"export-btn"},null,8,["onClick"]),i(w,{color:"teal",icon:"analytics",label:"Categories CSV",onClick:o.exportCategoryCSV,outline:"",dense:"",class:"export-btn"},null,8,["onClick"])])]),_:1})]),_:1})]),n("div",Ct,[i(z,{class:"compact-card"},{default:m(()=>[i(T,{class:"card-section"},{default:m(()=>[n("div",xt,[i(x,{name:"edit",size:"20px",class:"text-primary"}),Bt]),i(at,{onSubmit:o.addManualTransaction,class:"compact-form"},{default:m(()=>[n("div",St,[i(ae,{filled:"",modelValue:o.manualTransaction.date,"onUpdate:modelValue":g[1]||(g[1]=l=>o.manualTransaction.date=l),label:"Date",type:"date",dense:"",class:"full-width",required:""},null,8,["modelValue"]),i(ae,{filled:"",modelValue:o.manualTransaction.amount,"onUpdate:modelValue":g[2]||(g[2]=l=>o.manualTransaction.amount=l),modelModifiers:{number:!0},label:"Amount (â‚¬)",type:"number",step:"0.01",dense:"",required:""},null,8,["modelValue"]),i(ne,{filled:"",modelValue:o.manualTransaction.transaction_type,"onUpdate:modelValue":g[3]||(g[3]=l=>o.manualTransaction.transaction_type=l),options:o.transactionTypes,label:"Type",dense:"",required:"","emit-value":"","map-options":""},null,8,["modelValue","options"]),i(ne,{filled:"",modelValue:o.manualTransaction.category_id,"onUpdate:modelValue":g[4]||(g[4]=l=>o.manualTransaction.category_id=l),modelModifiers:{number:!0},options:o.categories,label:"Category","option-label":"name","option-value":"id",dense:"",required:"","emit-value":"","map-options":""},null,8,["modelValue","options"]),i(ae,{filled:"",modelValue:o.manualTransaction.description,"onUpdate:modelValue":g[5]||(g[5]=l=>o.manualTransaction.description=l),label:"Description",dense:"",required:"",class:"full-width"},null,8,["modelValue"]),i(ne,{filled:"",modelValue:o.manualTransaction.payment_method,"onUpdate:modelValue":g[6]||(g[6]=l=>o.manualTransaction.payment_method=l),options:o.paymentMethods,label:"Payment Method",dense:"","emit-value":"","map-options":"",class:"full-width"},null,8,["modelValue","options"])]),n("div",Et,[i(w,{label:"Save Transaction",type:"submit",color:"primary",icon:"save",loading:o.savingTransaction,class:"save-btn",dense:""},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),i(z,{class:"compact-card"},{default:m(()=>[i(T,{class:"card-section"},{default:m(()=>[n("div",It,[i(x,{name:"pie_chart",size:"20px",class:"text-primary"}),Dt]),n("div",Tt,[n("div",Vt,[n("div",At,[i(x,{name:"north",size:"18px"})]),n("div",Ft,[n("div",zt," +"+p(o.formatCurrency(o.categorySummary.totalIncome)),1),Nt])]),n("div",Mt,[n("div",Ut,[i(x,{name:"south",size:"18px"})]),n("div",Lt,[n("div",Qt," -"+p(o.formatCurrency(o.categorySummary.totalExpenses)),1),Ot])]),n("div",Rt,[n("div",Kt,[i(x,{name:"account_balance_wallet",size:"18px"})]),n("div",Pt,[n("div",{class:q(["stat-value",o.categorySummary.balance>=0?"text-positive":"text-negative"])},p(o.categorySummary.balance>=0?"+":"")+p(o.formatCurrency(o.categorySummary.balance)),3),jt])])]),n("div",qt,[(k(!0),F(ee,null,$(o.categorySummaries,l=>(k(),F("div",{key:l.id,class:"category-card",onClick:S=>o.openCategoryDialog(l)},[n("div",Ht,[n("div",Gt,p(l.name),1),n("div",Yt,p(l.transactionCount),1)]),n("div",Xt,[n("div",Zt,"+"+p(o.formatCurrency(l.income)),1),n("div",Jt,"-"+p(o.formatCurrency(l.expenses)),1),n("div",{class:q(["amount net",l.netAmount>=0?"positive":"negative"])},p(l.netAmount>=0?"+":"")+p(o.formatCurrency(l.netAmount)),3)])],8,Wt))),128))]),o.categorySummaries.length===0?(k(),F("div",$t,[i(x,{name:"pie_chart",size:"32px",color:"grey-4"}),ea,ta])):ue("",!0)]),_:1})]),_:1})])]),i(ot,{modelValue:o.showCategoryDialog,"onUpdate:modelValue":g[7]||(g[7]=l=>o.showCategoryDialog=l)},{default:m(()=>[i(z,{class:"dialog-card"},{default:m(()=>[i(T,{class:"dialog-header"},{default:m(()=>{var l;return[n("div",aa,p((l=o.activeCategory)==null?void 0:l.name),1),i(nt),Ge(i(w,{icon:"close",flat:"",round:"",dense:""},null,512),[[rt]])]}),_:1}),i(T,null,{default:m(()=>{var l,S,A,E,I;return[n("div",na,[n("div",oa,[sa,n("div",ra," +"+p(o.formatCurrency(((l=o.activeCategory)==null?void 0:l.income)||0)),1)]),n("div",ia,[ca,n("div",la," -"+p(o.formatCurrency(((S=o.activeCategory)==null?void 0:S.expenses)||0)),1)]),n("div",da,[ua,n("div",{class:q(["stat-value",(((A=o.activeCategory)==null?void 0:A.netAmount)||0)>=0?"text-positive":"text-negative"])},p((((E=o.activeCategory)==null?void 0:E.netAmount)||0)>=0?"+":"")+p(o.formatCurrency(((I=o.activeCategory)==null?void 0:I.netAmount)||0)),3)])]),i(Ye,{separator:"",dense:""},{default:m(()=>{var D;return[(k(!0),F(ee,null,$(((D=o.activeCategory)==null?void 0:D.transactions)||[],y=>(k(),Q(Xe,{key:y.id,class:"transaction-item"},{default:m(()=>[i(te,{avatar:""},{default:m(()=>[i(x,{name:y.transaction_type==="Einnahme"?"arrow_upward":"arrow_downward",color:y.transaction_type==="Einnahme"?"positive":"negative",size:"sm"},null,8,["name","color"])]),_:2},1024),i(te,null,{default:m(()=>[i(oe,{class:"transaction-description"},{default:m(()=>[j(p(y.description||"No description"),1)]),_:2},1024),i(oe,{caption:""},{default:m(()=>[j(p(o.formatDate(y.date))+" ",1),y.payment_method?(k(),F("span",ma,"â€¢ "+p(y.payment_method),1)):ue("",!0)]),_:2},1024)]),_:2},1024),i(te,{side:""},{default:m(()=>[i(oe,{class:q([y.transaction_type==="Einnahme"?"text-positive":"text-negative","text-weight-bold"])},{default:m(()=>[j(p(y.transaction_type==="Einnahme"?"+":"-")+p(o.formatCurrency(y.amount)),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024))),128))]}),_:1})]}),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const Ea=Pe(it,[["render",ga],["__scopeId","data-v-cc11aab7"]]);export{Ea as default};

import{a as k,y as B,P as Wt,z as Ea,c as St,A as Na,B as Jt,C as Ha,r as W,D as qa,E as $e,F as Yt,h as A,T as Ze,G as Va,k as fe,H as Ra,v as Ba,x as za,_ as Kt,I as ea,J as pt,b as Le,d as ja,w as xe,j as q,g as $,Q as ze,i as He,K as ge,L as Ua,M as Qa,N as Za,O as Ga,s as ta,t as aa,n as Xa,R as Wa,f as Ja,S as Lt,o as Ka,U as en}from"./index-D4jzW2ih.js";import{Q as tn}from"./QLinearProgress-Bd-LK6tJ.js";import{u as an}from"./use-render-cache-PZri9egM.js";import{u as nn,b as rn,c as on,Q as bt,a as ln}from"./QInput-Bqg2a1tB.js";import{Q as sn}from"./QDialog-C4hRUjbW.js";import{u as un,a as cn,Q as dn,b as vn}from"./QSelect-C16r4JlN.js";import{Q as fn}from"./QSpace-DwxzaiVY.js";import{P as de,D as It,r as Ot,a as na,d as gn,S as Pt,b as Ft,l as dt,n as hn,c as mn,g as yn,i as Et,p as Ce,m as ra,e as We,f as oa,s as pn,_ as _t,h as la,j as Ne,k as bn,Z as Dn,o as Je,q as vt,u as Nt,t as Sn,v as _n,w as Mn,x as wn,y as xn,z as Cn,C as $n,A as Ht,B as An,E as sa,F as kn,G as Tn,H as Yn,I as Ln,J as In,K as ia,L as ua,M as ca,N as da,O as va,Q as On,R as Pn,T as Fn,U as En}from"./index-5So85wTa.js";import{u as fa,Q as ga}from"./use-quasar-C2Rn4zlt.js";import{a as ft}from"./axios-DnX1qazU.js";import{E as qt}from"./jspdf.es.min-BtuinE6B.js";import{autoTable as Vt}from"./jspdf.plugin.autotable-bUJAAMeG.js";const Ie=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];function Nn(e,n,o){return Object.prototype.toString.call(e)==="[object Date]"&&(o=e.getDate(),n=e.getMonth()+1,e=e.getFullYear()),Rn(Mt(e,n,o))}function Rt(e,n,o){return ma(Vn(e,n,o))}function Hn(e){return qn(e)===0}function tt(e,n){return n<=6?31:n<=11||Hn(e)?30:29}function qn(e){const n=Ie.length;let o=Ie[0],a,i,s,c,u;if(e<o||e>=Ie[n-1])throw new Error("Invalid Jalaali year "+e);for(u=1;u<n&&(a=Ie[u],i=a-o,!(e<a));u+=1)o=a;return c=e-o,i-c<6&&(c=c-i+U(i+4,33)*33),s=be(be(c+1,33)-1,4),s===-1&&(s=4),s}function ha(e,n){const o=Ie.length,a=e+621;let i=-14,s=Ie[0],c,u,v,y,l;if(e<s||e>=Ie[o-1])throw new Error("Invalid Jalaali year "+e);for(l=1;l<o&&(c=Ie[l],u=c-s,!(e<c));l+=1)i=i+U(u,33)*8+U(be(u,33),4),s=c;y=e-s,i=i+U(y,33)*8+U(be(y,33)+3,4),be(u,33)===4&&u-y===4&&(i+=1);const g=U(a,4)-U((U(a,100)+1)*3,4)-150,p=20+i-g;return n||(u-y<6&&(y=y-u+U(u+4,33)*33),v=be(be(y+1,33)-1,4),v===-1&&(v=4)),{leap:v,gy:a,march:p}}function Vn(e,n,o){const a=ha(e,!0);return Mt(a.gy,3,a.march)+(n-1)*31-U(n,7)*(n-7)+o-1}function Rn(e){const n=ma(e).gy;let o=n-621,a,i,s;const c=ha(o,!1),u=Mt(n,3,c.march);if(s=e-u,s>=0){if(s<=185)return i=1+U(s,31),a=be(s,31)+1,{jy:o,jm:i,jd:a};s-=186}else o-=1,s+=179,c.leap===1&&(s+=1);return i=7+U(s,30),a=be(s,30)+1,{jy:o,jm:i,jd:a}}function Mt(e,n,o){let a=U((e+U(n-8,6)+100100)*1461,4)+U(153*be(n+9,12)+2,5)+o-34840408;return a=a-U(U(e+100100+U(n-8,6),100)*3,4)+752,a}function ma(e){let n=4*e+139361631;n=n+U(U(4*e+183187720,146097)*3,4)*4-3908;const o=U(be(n,1461),4)*5+308,a=U(be(o,153),5)+1,i=be(U(o,153),12)+1;return{gy:U(n,1461)-100100+U(8-i,6),gm:i,gd:a}}function U(e,n){return~~(e/n)}function be(e,n){return e-~~(e/n)*n}const Bn=["gregorian","persian"],zn={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:e=>Bn.includes(e),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},jn=["update:modelValue"];function Te(e){return e.year+"/"+B(e.month)+"/"+B(e.day)}function Un(e,n){const o=k(()=>e.disable!==!0&&e.readonly!==!0),a=k(()=>o.value===!0?0:-1),i=k(()=>{const u=[];return e.color!==void 0&&u.push(`bg-${e.color}`),e.textColor!==void 0&&u.push(`text-${e.textColor}`),u.join(" ")});function s(){return e.locale!==void 0?{...n.lang.date,...e.locale}:n.lang.date}function c(u){const v=new Date,y=u===!0?null:0;if(e.calendar==="persian"){const l=Nn(v);return{year:l.jy,month:l.jm,day:l.jd}}return{year:v.getFullYear(),month:v.getMonth()+1,day:v.getDate(),hour:y,minute:y,second:y,millisecond:y}}return{editable:o,tabindex:a,headerClass:i,getLocale:s,getCurrentDate:c}}const ya=864e5,Qn=36e5,Dt=6e4,pa="YYYY-MM-DDTHH:mm:ss.SSSZ",Zn=/\[((?:[^\]\\]|\\]|\\)*)\]|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,Gn=/(\[[^\]]*\])|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,gt={};function Xn(e,n){const o="("+n.days.join("|")+")",a=e+o;if(gt[a]!==void 0)return gt[a];const i="("+n.daysShort.join("|")+")",s="("+n.months.join("|")+")",c="("+n.monthsShort.join("|")+")",u={};let v=0;const y=e.replace(Gn,g=>{switch(v++,g){case"YY":return u.YY=v,"(-?\\d{1,2})";case"YYYY":return u.YYYY=v,"(-?\\d{1,4})";case"M":return u.M=v,"(\\d{1,2})";case"MM":return u.M=v,"(\\d{2})";case"MMM":return u.MMM=v,c;case"MMMM":return u.MMMM=v,s;case"D":return u.D=v,"(\\d{1,2})";case"Do":return u.D=v++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return u.D=v,"(\\d{2})";case"H":return u.H=v,"(\\d{1,2})";case"HH":return u.H=v,"(\\d{2})";case"h":return u.h=v,"(\\d{1,2})";case"hh":return u.h=v,"(\\d{2})";case"m":return u.m=v,"(\\d{1,2})";case"mm":return u.m=v,"(\\d{2})";case"s":return u.s=v,"(\\d{1,2})";case"ss":return u.s=v,"(\\d{2})";case"S":return u.S=v,"(\\d{1})";case"SS":return u.S=v,"(\\d{2})";case"SSS":return u.S=v,"(\\d{3})";case"A":return u.A=v,"(AM|PM)";case"a":return u.a=v,"(am|pm)";case"aa":return u.aa=v,"(a\\.m\\.|p\\.m\\.)";case"ddd":return i;case"dddd":return o;case"Q":case"d":case"E":return"(\\d{1})";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"w":return"(\\d{1,2})";case"ww":return"(\\d{2})";case"Z":return u.Z=v,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return u.ZZ=v,"(Z|[+-]\\d{2}\\d{2})";case"X":return u.X=v,"(-?\\d+)";case"x":return u.x=v,"(-?\\d{4,})";default:return v--,g[0]==="["&&(g=g.substring(1,g.length-1)),g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}),l={map:u,regex:new RegExp("^"+y)};return gt[a]=l,l}function ba(e,n){return e!==void 0?e:n!==void 0?n.date:Ea.date}function Bt(e,n=""){const o=e>0?"-":"+",a=Math.abs(e),i=Math.floor(a/60),s=a%60;return o+B(i)+n+B(s)}function Wn(e,n,o,a,i){const s={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(i!==void 0&&Object.assign(s,i),e==null||e===""||typeof e!="string")return s;n===void 0&&(n=pa);const c=ba(o,Wt.props),u=c.months,v=c.monthsShort,{regex:y,map:l}=Xn(n,c),g=e.match(y);if(g===null)return s;let p="";if(l.X!==void 0||l.x!==void 0){const m=parseInt(g[l.X!==void 0?l.X:l.x],10);if(isNaN(m)===!0||m<0)return s;const h=new Date(m*(l.X!==void 0?1e3:1));s.year=h.getFullYear(),s.month=h.getMonth()+1,s.day=h.getDate(),s.hour=h.getHours(),s.minute=h.getMinutes(),s.second=h.getSeconds(),s.millisecond=h.getMilliseconds()}else{if(l.YYYY!==void 0)s.year=parseInt(g[l.YYYY],10);else if(l.YY!==void 0){const m=parseInt(g[l.YY],10);s.year=m<0?m:2e3+m}if(l.M!==void 0){if(s.month=parseInt(g[l.M],10),s.month<1||s.month>12)return s}else l.MMM!==void 0?s.month=v.indexOf(g[l.MMM])+1:l.MMMM!==void 0&&(s.month=u.indexOf(g[l.MMMM])+1);if(l.D!==void 0){if(s.day=parseInt(g[l.D],10),s.year===null||s.month===null||s.day<1)return s;const m=a!=="persian"?new Date(s.year,s.month,0).getDate():tt(s.year,s.month);if(s.day>m)return s}l.H!==void 0?s.hour=parseInt(g[l.H],10)%24:l.h!==void 0&&(s.hour=parseInt(g[l.h],10)%12,(l.A&&g[l.A]==="PM"||l.a&&g[l.a]==="pm"||l.aa&&g[l.aa]==="p.m.")&&(s.hour+=12),s.hour=s.hour%24),l.m!==void 0&&(s.minute=parseInt(g[l.m],10)%60),l.s!==void 0&&(s.second=parseInt(g[l.s],10)%60),l.S!==void 0&&(s.millisecond=parseInt(g[l.S],10)*10**(3-g[l.S].length)),(l.Z!==void 0||l.ZZ!==void 0)&&(p=l.Z!==void 0?g[l.Z].replace(":",""):g[l.ZZ],s.timezoneOffset=(p[0]==="+"?-1:1)*(60*p.slice(1,3)+1*p.slice(3,5)))}return s.dateHash=B(s.year,6)+"/"+B(s.month)+"/"+B(s.day),s.timeHash=B(s.hour)+":"+B(s.minute)+":"+B(s.second)+p,s}function zt(e){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate());n.setDate(n.getDate()-(n.getDay()+6)%7+3);const o=new Date(n.getFullYear(),0,4);o.setDate(o.getDate()-(o.getDay()+6)%7+3);const a=n.getTimezoneOffset()-o.getTimezoneOffset();n.setHours(n.getHours()-a);const i=(n-o)/(ya*7);return 1+Math.floor(i)}function we(e,n,o){const a=new Date(e),i=`set${o===!0?"UTC":""}`;switch(n){case"year":case"years":a[`${i}Month`](0);case"month":case"months":a[`${i}Date`](1);case"day":case"days":case"date":a[`${i}Hours`](0);case"hour":case"hours":a[`${i}Minutes`](0);case"minute":case"minutes":a[`${i}Seconds`](0);case"second":case"seconds":a[`${i}Milliseconds`](0)}return a}function Ke(e,n,o){return(e.getTime()-e.getTimezoneOffset()*Dt-(n.getTime()-n.getTimezoneOffset()*Dt))/o}function Da(e,n,o="days"){const a=new Date(e),i=new Date(n);switch(o){case"years":case"year":return a.getFullYear()-i.getFullYear();case"months":case"month":return(a.getFullYear()-i.getFullYear())*12+a.getMonth()-i.getMonth();case"days":case"day":case"date":return Ke(we(a,"day"),we(i,"day"),ya);case"hours":case"hour":return Ke(we(a,"hour"),we(i,"hour"),Qn);case"minutes":case"minute":return Ke(we(a,"minute"),we(i,"minute"),Dt);case"seconds":case"second":return Ke(we(a,"second"),we(i,"second"),1e3)}}function jt(e){return Da(e,we(e,"year"),"days")+1}function Ut(e){if(e>=11&&e<=13)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`}return`${e}th`}const Qt={YY(e,n,o){const a=this.YYYY(e,n,o)%100;return a>=0?B(a):"-"+B(Math.abs(a))},YYYY(e,n,o){return o??e.getFullYear()},M(e){return e.getMonth()+1},MM(e){return B(e.getMonth()+1)},MMM(e,n){return n.monthsShort[e.getMonth()]},MMMM(e,n){return n.months[e.getMonth()]},Q(e){return Math.ceil((e.getMonth()+1)/3)},Qo(e){return Ut(this.Q(e))},D(e){return e.getDate()},Do(e){return Ut(e.getDate())},DD(e){return B(e.getDate())},DDD(e){return jt(e)},DDDD(e){return B(jt(e),3)},d(e){return e.getDay()},dd(e,n){return this.dddd(e,n).slice(0,2)},ddd(e,n){return n.daysShort[e.getDay()]},dddd(e,n){return n.days[e.getDay()]},E(e){return e.getDay()||7},w(e){return zt(e)},ww(e){return B(zt(e))},H(e){return e.getHours()},HH(e){return B(e.getHours())},h(e){const n=e.getHours();return n===0?12:n>12?n%12:n},hh(e){return B(this.h(e))},m(e){return e.getMinutes()},mm(e){return B(e.getMinutes())},s(e){return e.getSeconds()},ss(e){return B(e.getSeconds())},S(e){return Math.floor(e.getMilliseconds()/100)},SS(e){return B(Math.floor(e.getMilliseconds()/10))},SSS(e){return B(e.getMilliseconds(),3)},A(e){return this.H(e)<12?"AM":"PM"},a(e){return this.H(e)<12?"am":"pm"},aa(e){return this.H(e)<12?"a.m.":"p.m."},Z(e,n,o,a){const i=a??e.getTimezoneOffset();return Bt(i,":")},ZZ(e,n,o,a){const i=a??e.getTimezoneOffset();return Bt(i)},X(e){return Math.floor(e.getTime()/1e3)},x(e){return e.getTime()}};function Jn(e,n,o,a,i){if(e!==0&&!e||e===1/0||e===-1/0)return;const s=new Date(e);if(isNaN(s))return;n===void 0&&(n=pa);const c=ba(o,Wt.props);return n.replace(Zn,(u,v)=>u in Qt?Qt[u](s,c,a,i):v===void 0?u:v.split("\\]").join("]"))}const Ee=20,Kn=["Calendar","Years","Months"],Zt=e=>Kn.includes(e),ht=e=>/^-?[\d]+\/[0-1]\d$/.test(e),Be=" â€” ";function Ye(e){return e.year+"/"+B(e.month)}const er=St({name:"QDate",props:{...zn,...nn,...Na,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:ht},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:ht},navigationMaxYearMonth:{type:String,validator:ht},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:Zt}},emits:[...jn,"rangeStart","rangeEnd","navigation"],setup(e,{slots:n,emit:o}){const{proxy:a}=Jt(),{$q:i}=a,s=Ha(e,i),{getCache:c}=an(),{tabindex:u,headerClass:v,getLocale:y,getCurrentDate:l}=Un(e,i);let g;const p=rn(e),m=on(p),h=W(null),D=W(wt()),_=W(y()),Y=k(()=>wt()),N=k(()=>y()),L=k(()=>l()),w=W(xt(D.value,_.value)),O=W(e.defaultView),Q=i.lang.rtl===!0?"right":"left",Z=W(Q.value),P=W(Q.value),T=w.value.year,J=W(T-T%Ee-(T<0?Ee:0)),z=W(null),le=k(()=>{const t=e.landscape===!0?"landscape":"portrait";return`q-date q-date--${t} q-date--${t}-${e.minimal===!0?"minimal":"standard"}`+(s.value===!0?" q-date--dark q-dark":"")+(e.bordered===!0?" q-date--bordered":"")+(e.square===!0?" q-date--square no-border-radius":"")+(e.flat===!0?" q-date--flat no-shadow":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-date--readonly":"")}),G=k(()=>e.color||"primary"),se=k(()=>e.textColor||"white"),ee=k(()=>e.emitImmediately===!0&&e.multiple!==!0&&e.range!==!0),he=k(()=>Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue!==null&&e.modelValue!==void 0?[e.modelValue]:[]),V=k(()=>he.value.filter(t=>typeof t=="string").map(t=>lt(t,D.value,_.value)).filter(t=>t.dateHash!==null&&t.day!==null&&t.month!==null&&t.year!==null)),X=k(()=>{const t=r=>lt(r,D.value,_.value);return he.value.filter(r=>qa(r)===!0&&r.from!==void 0&&r.to!==void 0).map(r=>({from:t(r.from),to:t(r.to)})).filter(r=>r.from.dateHash!==null&&r.to.dateHash!==null&&r.from.dateHash<r.to.dateHash)}),H=k(()=>e.calendar!=="persian"?t=>new Date(t.year,t.month-1,t.day):t=>{const r=Rt(t.year,t.month,t.day);return new Date(r.gy,r.gm-1,r.gd)}),f=k(()=>e.calendar==="persian"?Te:(t,r,d)=>Jn(new Date(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),r===void 0?D.value:r,d===void 0?_.value:d,t.year,t.timezoneOffset)),b=k(()=>V.value.length+X.value.reduce((t,r)=>t+1+Da(H.value(r.to),H.value(r.from)),0)),x=k(()=>{if(e.title!==void 0&&e.title!==null&&e.title.length!==0)return e.title;if(z.value!==null){const d=z.value.init,S=H.value(d);return _.value.daysShort[S.getDay()]+", "+_.value.monthsShort[d.month-1]+" "+d.day+Be+"?"}if(b.value===0)return Be;if(b.value>1)return`${b.value} ${_.value.pluralDay}`;const t=V.value[0],r=H.value(t);return isNaN(r.valueOf())===!0?Be:_.value.headerTitle!==void 0?_.value.headerTitle(r,t):_.value.daysShort[r.getDay()]+", "+_.value.monthsShort[t.month-1]+" "+t.day}),F=k(()=>V.value.concat(X.value.map(r=>r.from)).sort((r,d)=>r.year-d.year||r.month-d.month)[0]),R=k(()=>V.value.concat(X.value.map(r=>r.to)).sort((r,d)=>d.year-r.year||d.month-r.month)[0]),ie=k(()=>{if(e.subtitle!==void 0&&e.subtitle!==null&&e.subtitle.length!==0)return e.subtitle;if(b.value===0)return Be;if(b.value>1){const t=F.value,r=R.value,d=_.value.monthsShort;return d[t.month-1]+(t.year!==r.year?" "+t.year+Be+d[r.month-1]+" ":t.month!==r.month?Be+d[r.month-1]:"")+" "+r.year}return V.value[0].year}),Se=k(()=>{const t=[i.iconSet.datetime.arrowLeft,i.iconSet.datetime.arrowRight];return i.lang.rtl===!0?t.reverse():t}),_e=k(()=>e.firstDayOfWeek!==void 0?Number(e.firstDayOfWeek):_.value.firstDayOfWeek),ye=k(()=>{const t=_.value.daysShort,r=_e.value;return r>0?t.slice(r,7).concat(t.slice(0,r)):t}),ne=k(()=>{const t=w.value;return e.calendar!=="persian"?new Date(t.year,t.month,0).getDate():tt(t.year,t.month)}),pe=k(()=>typeof e.eventColor=="function"?e.eventColor:()=>e.eventColor),te=k(()=>{if(e.navigationMinYearMonth===void 0)return null;const t=e.navigationMinYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),ae=k(()=>{if(e.navigationMaxYearMonth===void 0)return null;const t=e.navigationMaxYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),ue=k(()=>{const t={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return te.value!==null&&te.value.year>=w.value.year&&(t.year.prev=!1,te.value.year===w.value.year&&te.value.month>=w.value.month&&(t.month.prev=!1)),ae.value!==null&&ae.value.year<=w.value.year&&(t.year.next=!1,ae.value.year===w.value.year&&ae.value.month<=w.value.month&&(t.month.next=!1)),t}),re=k(()=>{const t={};return V.value.forEach(r=>{const d=Ye(r);t[d]===void 0&&(t[d]=[]),t[d].push(r.day)}),t}),De=k(()=>{const t={};return X.value.forEach(r=>{const d=Ye(r.from),S=Ye(r.to);if(t[d]===void 0&&(t[d]=[]),t[d].push({from:r.from.day,to:d===S?r.to.day:void 0,range:r}),d<S){let M;const{year:E,month:C}=r.from,I=C<12?{year:E,month:C+1}:{year:E+1,month:1};for(;(M=Ye(I))<=S;)t[M]===void 0&&(t[M]=[]),t[M].push({from:void 0,to:M===S?r.to.day:void 0,range:r}),I.month++,I.month>12&&(I.year++,I.month=1)}}),t}),ve=k(()=>{if(z.value===null)return;const{init:t,initHash:r,final:d,finalHash:S}=z.value,[M,E]=r<=S?[t,d]:[d,t],C=Ye(M),I=Ye(E);if(C!==oe.value&&I!==oe.value)return;const j={};return C===oe.value?(j.from=M.day,j.includeFrom=!0):j.from=1,I===oe.value?(j.to=E.day,j.includeTo=!0):j.to=ne.value,j}),oe=k(()=>Ye(w.value)),nt=k(()=>{const t={};if(e.options===void 0){for(let d=1;d<=ne.value;d++)t[d]=!0;return t}const r=typeof e.options=="function"?e.options:d=>e.options.includes(d);for(let d=1;d<=ne.value;d++){const S=oe.value+"/"+B(d);t[d]=r(S)}return t}),Ae=k(()=>{const t={};if(e.events===void 0)for(let r=1;r<=ne.value;r++)t[r]=!1;else{const r=typeof e.events=="function"?e.events:d=>e.events.includes(d);for(let d=1;d<=ne.value;d++){const S=oe.value+"/"+B(d);t[d]=r(S)===!0&&pe.value(S)}}return t}),rt=k(()=>{let t,r;const{year:d,month:S}=w.value;if(e.calendar!=="persian")t=new Date(d,S-1,1),r=new Date(d,S-1,0).getDate();else{const M=Rt(d,S,1);t=new Date(M.gy,M.gm-1,M.gd);let E=S-1,C=d;E===0&&(E=12,C--),r=tt(C,E)}return{days:t.getDay()-_e.value-1,endDay:r}}),ke=k(()=>{const t=[],{days:r,endDay:d}=rt.value,S=r<0?r+7:r;if(S<6)for(let C=d-S;C<=d;C++)t.push({i:C,fill:!0});const M=t.length;for(let C=1;C<=ne.value;C++){const I={i:C,event:Ae.value[C],classes:[]};nt.value[C]===!0&&(I.in=!0,I.flat=!0),t.push(I)}if(re.value[oe.value]!==void 0&&re.value[oe.value].forEach(C=>{const I=M+C-1;Object.assign(t[I],{selected:!0,unelevated:!0,flat:!1,color:G.value,textColor:se.value})}),De.value[oe.value]!==void 0&&De.value[oe.value].forEach(C=>{if(C.from!==void 0){const I=M+C.from-1,j=M+(C.to||ne.value)-1;for(let Qe=I;Qe<=j;Qe++)Object.assign(t[Qe],{range:C.range,unelevated:!0,color:G.value,textColor:se.value});Object.assign(t[I],{rangeFrom:!0,flat:!1}),C.to!==void 0&&Object.assign(t[j],{rangeTo:!0,flat:!1})}else if(C.to!==void 0){const I=M+C.to-1;for(let j=M;j<=I;j++)Object.assign(t[j],{range:C.range,unelevated:!0,color:G.value,textColor:se.value});Object.assign(t[I],{flat:!1,rangeTo:!0})}else{const I=M+ne.value-1;for(let j=M;j<=I;j++)Object.assign(t[j],{range:C.range,unelevated:!0,color:G.value,textColor:se.value})}}),ve.value!==void 0){const C=M+ve.value.from-1,I=M+ve.value.to-1;for(let j=C;j<=I;j++)t[j].color=G.value,t[j].editRange=!0;ve.value.includeFrom===!0&&(t[C].editRangeFrom=!0),ve.value.includeTo===!0&&(t[I].editRangeTo=!0)}w.value.year===L.value.year&&w.value.month===L.value.month&&(t[M+L.value.day-1].today=!0);const E=t.length%7;if(E>0){const C=7-E;for(let I=1;I<=C;I++)t.push({i:I,fill:!0})}return t.forEach(C=>{let I="q-date__calendar-item ";C.fill===!0?I+="q-date__calendar-item--fill":(I+=`q-date__calendar-item--${C.in===!0?"in":"out"}`,C.range!==void 0&&(I+=` q-date__range${C.rangeTo===!0?"-to":C.rangeFrom===!0?"-from":""}`),C.editRange===!0&&(I+=` q-date__edit-range${C.editRangeFrom===!0?"-from":""}${C.editRangeTo===!0?"-to":""}`),(C.range!==void 0||C.editRange===!0)&&(I+=` text-${C.color}`)),C.classes=I}),t}),Ge=k(()=>e.disable===!0?{"aria-disabled":"true"}:{});$e(()=>e.modelValue,t=>{if(g===t)g=0;else{const r=xt(D.value,_.value);Ve(r.year,r.month,r)}}),$e(O,()=>{h.value!==null&&a.$el.contains(document.activeElement)===!0&&h.value.focus()}),$e(()=>w.value.year+"|"+w.value.month,()=>{o("navigation",{year:w.value.year,month:w.value.month})}),$e(Y,t=>{Tt(t,_.value,"mask"),D.value=t}),$e(N,t=>{Tt(D.value,t,"locale"),_.value=t});function qe(){const{year:t,month:r,day:d}=L.value,S={...w.value,year:t,month:r,day:d},M=re.value[Ye(S)];(M===void 0||M.includes(S.day)===!1)&&it(S),ot(S.year,S.month)}function $a(t){Zt(t)===!0&&(O.value=t)}function Aa(t,r){["month","year"].includes(t)&&(t==="month"?$t:st)(r===!0?-1:1)}function ot(t,r){O.value="Calendar",Ve(t,r)}function ka(t,r){if(e.range===!1||!t){z.value=null;return}const d=Object.assign({...w.value},t),S=r!==void 0?Object.assign({...w.value},r):d;z.value={init:d,initHash:Te(d),final:S,finalHash:Te(S)},ot(d.year,d.month)}function wt(){return e.calendar==="persian"?"YYYY/MM/DD":e.mask}function lt(t,r,d){return Wn(t,r,d,e.calendar,{hour:0,minute:0,second:0,millisecond:0})}function xt(t,r){const d=Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue?[e.modelValue]:[];if(d.length===0)return Ct();const S=d[d.length-1],M=lt(S.from!==void 0?S.from:S,t,r);return M.dateHash===null?Ct():M}function Ct(){let t,r;if(e.defaultYearMonth!==void 0){const d=e.defaultYearMonth.split("/");t=parseInt(d[0],10),r=parseInt(d[1],10)}else{const d=L.value!==void 0?L.value:l();t=d.year,r=d.month}return{year:t,month:r,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:t+"/"+B(r)+"/01"}}function $t(t){let r=w.value.year,d=Number(w.value.month)+t;d===13?(d=1,r++):d===0&&(d=12,r--),Ve(r,d),ee.value===!0&&Xe("month")}function st(t){const r=Number(w.value.year)+t;Ve(r,w.value.month),ee.value===!0&&Xe("year")}function Ta(t){Ve(t,w.value.month),O.value=e.defaultView==="Years"?"Months":"Calendar",ee.value===!0&&Xe("year")}function Ya(t){Ve(w.value.year,t),O.value="Calendar",ee.value===!0&&Xe("month")}function La(t,r){const d=re.value[r];(d!==void 0&&d.includes(t.day)===!0?ut:it)(t)}function Fe(t){return{year:t.year,month:t.month,day:t.day}}function Ve(t,r,d){if(te.value!==null&&t<=te.value.year&&((r<te.value.month||t<te.value.year)&&(r=te.value.month),t=te.value.year),ae.value!==null&&t>=ae.value.year&&((r>ae.value.month||t>ae.value.year)&&(r=ae.value.month),t=ae.value.year),d!==void 0){const{hour:M,minute:E,second:C,millisecond:I,timezoneOffset:j,timeHash:Qe}=d;Object.assign(w.value,{hour:M,minute:E,second:C,millisecond:I,timezoneOffset:j,timeHash:Qe})}const S=t+"/"+B(r)+"/01";S!==w.value.dateHash&&(Z.value=w.value.dateHash<S==(i.lang.rtl!==!0)?"left":"right",t!==w.value.year&&(P.value=Z.value),Yt(()=>{J.value=t-t%Ee-(t<0?Ee:0),Object.assign(w.value,{year:t,month:r,day:1,dateHash:S})}))}function At(t,r,d){const S=t!==null&&t.length===1&&e.multiple===!1?t[0]:t;g=S;const{reason:M,details:E}=kt(r,d);o("update:modelValue",S,M,E)}function Xe(t){const r=V.value[0]!==void 0&&V.value[0].dateHash!==null?{...V.value[0]}:{...w.value};Yt(()=>{r.year=w.value.year,r.month=w.value.month;const d=e.calendar!=="persian"?new Date(r.year,r.month,0).getDate():tt(r.year,r.month);r.day=Math.min(Math.max(1,r.day),d);const S=Re(r);g=S;const{details:M}=kt("",r);o("update:modelValue",S,t,M)})}function kt(t,r){return r.from!==void 0?{reason:`${t}-range`,details:{...Fe(r.target),from:Fe(r.from),to:Fe(r.to)}}:{reason:`${t}-day`,details:Fe(r)}}function Re(t,r,d){return t.from!==void 0?{from:f.value(t.from,r,d),to:f.value(t.to,r,d)}:f.value(t,r,d)}function it(t){let r;if(e.multiple===!0)if(t.from!==void 0){const d=Te(t.from),S=Te(t.to),M=V.value.filter(C=>C.dateHash<d||C.dateHash>S),E=X.value.filter(({from:C,to:I})=>I.dateHash<d||C.dateHash>S);r=M.concat(E).concat(t).map(C=>Re(C))}else{const d=he.value.slice();d.push(Re(t)),r=d}else r=Re(t);At(r,"add",t)}function ut(t){if(e.noUnset===!0)return;let r=null;if(e.multiple===!0&&Array.isArray(e.modelValue)===!0){const d=Re(t);t.from!==void 0?r=e.modelValue.filter(S=>S.from!==void 0?S.from!==d.from&&S.to!==d.to:!0):r=e.modelValue.filter(S=>S!==d),r.length===0&&(r=null)}At(r,"remove",t)}function Tt(t,r,d){const S=V.value.concat(X.value).map(M=>Re(M,t,r)).filter(M=>M.from!==void 0?M.from.dateHash!==null&&M.to.dateHash!==null:M.dateHash!==null);o("update:modelValue",(e.multiple===!0?S:S[0])||null,d)}function Ia(){if(e.minimal!==!0)return A("div",{class:"q-date__header "+v.value},[A("div",{class:"relative-position"},[A(Ze,{name:"q-transition--fade"},()=>A("div",{key:"h-yr-"+ie.value,class:"q-date__header-subtitle q-date__header-link "+(O.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:u.value,...c("vY",{onClick(){O.value="Years"},onKeyup(t){t.keyCode===13&&(O.value="Years")}})},[ie.value]))]),A("div",{class:"q-date__header-title relative-position flex no-wrap"},[A("div",{class:"relative-position col"},[A(Ze,{name:"q-transition--fade"},()=>A("div",{key:"h-sub"+x.value,class:"q-date__header-title-label q-date__header-link "+(O.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:u.value,...c("vC",{onClick(){O.value="Calendar"},onKeyup(t){t.keyCode===13&&(O.value="Calendar")}})},[x.value]))]),e.todayBtn===!0?A(fe,{class:"q-date__header-today self-start",icon:i.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:u.value,onClick:qe}):null])])}function ct({label:t,type:r,key:d,dir:S,goTo:M,boundaries:E,cls:C}){return[A("div",{class:"row items-center q-date__arrow"},[A(fe,{round:!0,dense:!0,size:"sm",flat:!0,icon:Se.value[0],tabindex:u.value,disable:E.prev===!1,...c("go-#"+r,{onClick(){M(-1)}})})]),A("div",{class:"relative-position overflow-hidden flex flex-center"+C},[A(Ze,{name:"q-transition--jump-"+S},()=>A("div",{key:d},[A(fe,{flat:!0,dense:!0,noCaps:!0,label:t,tabindex:u.value,...c("view#"+r,{onClick:()=>{O.value=r}})})]))]),A("div",{class:"row items-center q-date__arrow"},[A(fe,{round:!0,dense:!0,size:"sm",flat:!0,icon:Se.value[1],tabindex:u.value,disable:E.next===!1,...c("go+#"+r,{onClick(){M(1)}})})])]}const Oa={Calendar:()=>[A("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[A("div",{class:"q-date__navigation row items-center no-wrap"},ct({label:_.value.months[w.value.month-1],type:"Months",key:w.value.month,dir:Z.value,goTo:$t,boundaries:ue.value.month,cls:" col"}).concat(ct({label:w.value.year,type:"Years",key:w.value.year,dir:P.value,goTo:st,boundaries:ue.value.year,cls:""}))),A("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},ye.value.map(t=>A("div",{class:"q-date__calendar-item"},[A("div",t)]))),A("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[A(Ze,{name:"q-transition--slide-"+Z.value},()=>A("div",{key:oe.value,class:"q-date__calendar-days fit"},ke.value.map(t=>A("div",{class:t.classes},[t.in===!0?A(fe,{class:t.today===!0?"q-date__today":"",dense:!0,flat:t.flat,unelevated:t.unelevated,color:t.color,textColor:t.textColor,label:t.i,tabindex:u.value,...c("day#"+t.i,{onClick:()=>{Pa(t.i)},onMouseover:()=>{Fa(t.i)}})},t.event!==!1?()=>A("div",{class:"q-date__event bg-"+t.event}):null):A("div",""+t.i)]))))])])],Months(){const t=w.value.year===L.value.year,r=S=>te.value!==null&&w.value.year===te.value.year&&te.value.month>S||ae.value!==null&&w.value.year===ae.value.year&&ae.value.month<S,d=_.value.monthsShort.map((S,M)=>{const E=w.value.month===M+1;return A("div",{class:"q-date__months-item flex flex-center"},[A(fe,{class:t===!0&&L.value.month===M+1?"q-date__today":null,flat:E!==!0,label:S,unelevated:E,color:E===!0?G.value:null,textColor:E===!0?se.value:null,tabindex:u.value,disable:r(M+1),...c("month#"+M,{onClick:()=>{Ya(M+1)}})})])});return e.yearsInMonthView===!0&&d.unshift(A("div",{class:"row no-wrap full-width"},[ct({label:w.value.year,type:"Years",key:w.value.year,dir:P.value,goTo:st,boundaries:ue.value.year,cls:" col"})])),A("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},d)},Years(){const t=J.value,r=t+Ee,d=[],S=M=>te.value!==null&&te.value.year>M||ae.value!==null&&ae.value.year<M;for(let M=t;M<=r;M++){const E=w.value.year===M;d.push(A("div",{class:"q-date__years-item flex flex-center"},[A(fe,{key:"yr"+M,class:L.value.year===M?"q-date__today":null,flat:!E,label:M,dense:!0,unelevated:E,color:E===!0?G.value:null,textColor:E===!0?se.value:null,tabindex:u.value,disable:S(M),...c("yr#"+M,{onClick:()=>{Ta(M)}})})]))}return A("div",{class:"q-date__view q-date__years flex flex-center"},[A("div",{class:"col-auto"},[A(fe,{round:!0,dense:!0,flat:!0,icon:Se.value[0],tabindex:u.value,disable:S(t),...c("y-",{onClick:()=>{J.value-=Ee}})})]),A("div",{class:"q-date__years-content col self-stretch row items-center"},d),A("div",{class:"col-auto"},[A(fe,{round:!0,dense:!0,flat:!0,icon:Se.value[1],tabindex:u.value,disable:S(r),...c("y+",{onClick:()=>{J.value+=Ee}})})])])}};function Pa(t){const r={...w.value,day:t};if(e.range===!1){La(r,oe.value);return}if(z.value===null){const d=ke.value.find(M=>M.fill!==!0&&M.i===t);if(e.noUnset!==!0&&d.range!==void 0){ut({target:r,from:d.range.from,to:d.range.to});return}if(d.selected===!0){ut(r);return}const S=Te(r);z.value={init:r,initHash:S,final:r,finalHash:S},o("rangeStart",Fe(r))}else{const d=z.value.initHash,S=Te(r),M=d<=S?{from:z.value.init,to:r}:{from:r,to:z.value.init};z.value=null,it(d===S?r:{target:r,...M}),o("rangeEnd",{from:Fe(M.from),to:Fe(M.to)})}}function Fa(t){if(z.value!==null){const r={...w.value,day:t};Object.assign(z.value,{final:r,finalHash:Te(r)})}}return Object.assign(a,{setToday:qe,setView:$a,offsetCalendar:Aa,setCalendarTo:ot,setEditingRange:ka}),()=>{const t=[A("div",{class:"q-date__content col relative-position"},[A(Ze,{name:"q-transition--fade"},Oa[O.value])])],r=Va(n.default);return r!==void 0&&t.push(A("div",{class:"q-date__actions"},r)),e.name!==void 0&&e.disable!==!0&&m(t,"push"),A("div",{class:le.value,...Ge.value},[Ia(),A("div",{ref:h,class:"q-date__main col column",tabindex:-1},t)])}}}),tr=St({name:"QPopupProxy",props:{...un,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(e,{slots:n,emit:o,attrs:a}){const{proxy:i}=Jt(),{$q:s}=i,c=W(!1),u=W(null),v=k(()=>parseInt(e.breakpoint,10)),{canShow:y}=cn({showing:c});function l(){return s.screen.width<v.value||s.screen.height<v.value?"dialog":"menu"}const g=W(l()),p=k(()=>g.value==="menu"?{maxHeight:"99vh"}:{});$e(()=>l(),D=>{c.value!==!0&&(g.value=D)});function m(D){c.value=!0,o("show",D)}function h(D){c.value=!1,g.value=l(),o("hide",D)}return Object.assign(i,{show(D){y(D)===!0&&u.value.show(D)},hide(D){u.value.hide(D)},toggle(D){u.value.toggle(D)}}),Ra(i,"currentComponent",()=>({type:g.value,ref:u.value})),()=>{const D={ref:u,...p.value,...a,onShow:m,onHide:h};let _;return g.value==="dialog"?_=sn:(_=dn,Object.assign(D,{target:e.target,contextMenu:e.contextMenu,noParentEvent:!0,separateClosePopup:!0})),A(_,D,n.default)}}}),ar=[A("g",{transform:"translate(-20,-20)"},[A("path",{d:"M79.9,52.6C80,51.8,80,50.9,80,50s0-1.8-0.1-2.6l-5.1-0.4c-0.3-2.4-0.9-4.6-1.8-6.7l4.2-2.9c-0.7-1.6-1.6-3.1-2.6-4.5 L70,35c-1.4-1.9-3.1-3.5-4.9-4.9l2.2-4.6c-1.4-1-2.9-1.9-4.5-2.6L59.8,27c-2.1-0.9-4.4-1.5-6.7-1.8l-0.4-5.1C51.8,20,50.9,20,50,20 s-1.8,0-2.6,0.1l-0.4,5.1c-2.4,0.3-4.6,0.9-6.7,1.8l-2.9-4.1c-1.6,0.7-3.1,1.6-4.5,2.6l2.1,4.6c-1.9,1.4-3.5,3.1-5,4.9l-4.5-2.1 c-1,1.4-1.9,2.9-2.6,4.5l4.1,2.9c-0.9,2.1-1.5,4.4-1.8,6.8l-5,0.4C20,48.2,20,49.1,20,50s0,1.8,0.1,2.6l5,0.4 c0.3,2.4,0.9,4.7,1.8,6.8l-4.1,2.9c0.7,1.6,1.6,3.1,2.6,4.5l4.5-2.1c1.4,1.9,3.1,3.5,5,4.9l-2.1,4.6c1.4,1,2.9,1.9,4.5,2.6l2.9-4.1 c2.1,0.9,4.4,1.5,6.7,1.8l0.4,5.1C48.2,80,49.1,80,50,80s1.8,0,2.6-0.1l0.4-5.1c2.3-0.3,4.6-0.9,6.7-1.8l2.9,4.2 c1.6-0.7,3.1-1.6,4.5-2.6L65,69.9c1.9-1.4,3.5-3,4.9-4.9l4.6,2.2c1-1.4,1.9-2.9,2.6-4.5L73,59.8c0.9-2.1,1.5-4.4,1.8-6.7L79.9,52.6 z M50,65c-8.3,0-15-6.7-15-15c0-8.3,6.7-15,15-15s15,6.7,15,15C65,58.3,58.3,65,50,65z",fill:"currentColor"},[A("animateTransform",{attributeName:"transform",type:"rotate",from:"90 50 50",to:"0 50 50",dur:"1s",repeatCount:"indefinite"})])]),A("g",{transform:"translate(20,20) rotate(15 50 50)"},[A("path",{d:"M79.9,52.6C80,51.8,80,50.9,80,50s0-1.8-0.1-2.6l-5.1-0.4c-0.3-2.4-0.9-4.6-1.8-6.7l4.2-2.9c-0.7-1.6-1.6-3.1-2.6-4.5 L70,35c-1.4-1.9-3.1-3.5-4.9-4.9l2.2-4.6c-1.4-1-2.9-1.9-4.5-2.6L59.8,27c-2.1-0.9-4.4-1.5-6.7-1.8l-0.4-5.1C51.8,20,50.9,20,50,20 s-1.8,0-2.6,0.1l-0.4,5.1c-2.4,0.3-4.6,0.9-6.7,1.8l-2.9-4.1c-1.6,0.7-3.1,1.6-4.5,2.6l2.1,4.6c-1.9,1.4-3.5,3.1-5,4.9l-4.5-2.1 c-1,1.4-1.9,2.9-2.6,4.5l4.1,2.9c-0.9,2.1-1.5,4.4-1.8,6.8l-5,0.4C20,48.2,20,49.1,20,50s0,1.8,0.1,2.6l5,0.4 c0.3,2.4,0.9,4.7,1.8,6.8l-4.1,2.9c0.7,1.6,1.6,3.1,2.6,4.5l4.5-2.1c1.4,1.9,3.1,3.5,5,4.9l-2.1,4.6c1.4,1,2.9,1.9,4.5,2.6l2.9-4.1 c2.1,0.9,4.4,1.5,6.7,1.8l0.4,5.1C48.2,80,49.1,80,50,80s1.8,0,2.6-0.1l0.4-5.1c2.3-0.3,4.6-0.9,6.7-1.8l2.9,4.2 c1.6-0.7,3.1-1.6,4.5-2.6L65,69.9c1.9-1.4,3.5-3,4.9-4.9l4.6,2.2c1-1.4,1.9-2.9,2.6-4.5L73,59.8c0.9-2.1,1.5-4.4,1.8-6.7L79.9,52.6 z M50,65c-8.3,0-15-6.7-15-15c0-8.3,6.7-15,15-15s15,6.7,15,15C65,58.3,58.3,65,50,65z",fill:"currentColor"},[A("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"90 50 50",dur:"1s",repeatCount:"indefinite"})])])],nr=St({name:"QSpinnerGears",props:Ba,setup(e){const{cSize:n,classes:o}=za(e);return()=>A("svg",{class:o.value,width:n.value,height:n.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},ar)}});function Sa(e,n,o,a,i,s,c,u){var v=i-e,y=s-n,l=o-e,g=a-n,p=Math.sqrt(l*l+g*g);l/=p,g/=p;var m=v*l+y*g,h=m/p;u&&(h=Math.min(Math.max(h,0),1)),h*=p;var D=c[0]=e+h*l,_=c[1]=n+h*g;return Math.sqrt((D-i)*(D-i)+(_-s)*(_-s))}var Oe=new de,K=new de,ce=new de,Pe=new de,Me=new de,at=[],me=new de;function rr(e,n){if(n<=180&&n>0){n=n/180*Math.PI,Oe.fromArray(e[0]),K.fromArray(e[1]),ce.fromArray(e[2]),de.sub(Pe,Oe,K),de.sub(Me,ce,K);var o=Pe.len(),a=Me.len();if(!(o<.001||a<.001)){Pe.scale(1/o),Me.scale(1/a);var i=Pe.dot(Me),s=Math.cos(n);if(s<i){var c=Sa(K.x,K.y,ce.x,ce.y,Oe.x,Oe.y,at,!1);me.fromArray(at),me.scaleAndAdd(Me,c/Math.tan(Math.PI-n));var u=ce.x!==K.x?(me.x-K.x)/(ce.x-K.x):(me.y-K.y)/(ce.y-K.y);if(isNaN(u))return;u<0?de.copy(me,K):u>1&&de.copy(me,ce),me.toArray(e[1])}}}}function or(e,n,o){if(o<=180&&o>0){o=o/180*Math.PI,Oe.fromArray(e[0]),K.fromArray(e[1]),ce.fromArray(e[2]),de.sub(Pe,K,Oe),de.sub(Me,ce,K);var a=Pe.len(),i=Me.len();if(!(a<.001||i<.001)){Pe.scale(1/a),Me.scale(1/i);var s=Pe.dot(n),c=Math.cos(o);if(s<c){var u=Sa(K.x,K.y,ce.x,ce.y,Oe.x,Oe.y,at,!1);me.fromArray(at);var v=Math.PI/2,y=Math.acos(Me.dot(n)),l=v+y-o;if(l>=v)de.copy(me,ce);else{me.scaleAndAdd(Me,u/Math.tan(Math.PI/2-l));var g=ce.x!==K.x?(me.x-K.x)/(ce.x-K.x):(me.y-K.y)/(ce.y-K.y);if(isNaN(g))return;g<0?de.copy(me,K):g>1&&de.copy(me,ce)}me.toArray(e[1])}}}}function mt(e,n,o,a){var i=o==="normal",s=i?e:e.ensureState(o);s.ignore=n;var c=a.get("smooth");c&&c===!0&&(c=.3),s.shape=s.shape||{},c>0&&(s.shape.smooth=c);var u=a.getModel("lineStyle").getLineStyle();i?e.useStyle(u):s.style=u}function lr(e,n){var o=n.smooth,a=n.points;if(a)if(e.moveTo(a[0][0],a[0][1]),o>0&&a.length>=3){var i=Ft(a[0],a[1]),s=Ft(a[1],a[2]);if(!i||!s){e.lineTo(a[1][0],a[1][1]),e.lineTo(a[2][0],a[2][1]);return}var c=Math.min(i,s)*o,u=dt([],a[1],a[0],c/i),v=dt([],a[1],a[2],c/s),y=dt([],u,v,.5);e.bezierCurveTo(u[0],u[1],u[0],u[1],y[0],y[1]),e.bezierCurveTo(v[0],v[1],v[0],v[1],a[2][0],a[2][1])}else for(var l=1;l<a.length;l++)e.lineTo(a[l][0],a[l][1])}function sr(e,n,o){var a=e.getTextGuideLine(),i=e.getTextContent();if(!i){a&&e.removeTextGuideLine();return}for(var s=n.normal,c=s.get("show"),u=i.ignore,v=0;v<It.length;v++){var y=It[v],l=n[y],g=y==="normal";if(l){var p=l.get("show"),m=g?u:Ot(i.states[y]&&i.states[y].ignore,u);if(m||!Ot(p,c)){var h=g?a:a&&a.states[y];h&&(h.ignore=!0),a&&mt(a,!0,y,l);continue}a||(a=new na,e.setTextGuideLine(a),!g&&(u||!c)&&mt(a,!0,"normal",n.normal),e.stateProxy&&(a.stateProxy=e.stateProxy)),mt(a,!1,y,l)}}if(a){gn(a.style,o),a.style.fill=null;var D=s.get("showAbove"),_=e.textGuideLineConfig=e.textGuideLineConfig||{};_.showAbove=D||!1,a.buildPath=lr}}function ir(e,n){n=n||"labelLine";for(var o={normal:e.getModel(n)},a=0;a<Pt.length;a++){var i=Pt[a];o[i]=e.getModel([i,n])}return o}var Gt=Math.PI*2,et=Math.PI/180;function _a(e,n){return yn(e.getBoxLayoutParams(),{width:n.getWidth(),height:n.getHeight()})}function Ma(e,n){var o=_a(e,n),a=e.get("center"),i=e.get("radius");Et(i)||(i=[0,i]);var s=Ce(o.width,n.getWidth()),c=Ce(o.height,n.getHeight()),u=Math.min(s,c),v=Ce(i[0],u/2),y=Ce(i[1],u/2),l,g,p=e.coordinateSystem;if(p){var m=p.dataToPoint(a);l=m[0]||0,g=m[1]||0}else Et(a)||(a=[a,a]),l=Ce(a[0],s)+o.x,g=Ce(a[1],c)+o.y;return{cx:l,cy:g,r0:v,r:y}}function ur(e,n,o){n.eachSeriesByType(e,function(a){var i=a.getData(),s=i.mapDimension("value"),c=_a(a,o),u=Ma(a,o),v=u.cx,y=u.cy,l=u.r,g=u.r0,p=-a.get("startAngle")*et,m=a.get("endAngle"),h=a.get("padAngle")*et;m=m==="auto"?p-Gt:-m*et;var D=a.get("minAngle")*et,_=D+h,Y=0;i.each(s,function(V){!isNaN(V)&&Y++});var N=i.getSum(s),L=Math.PI/(N||Y)*2,w=a.get("clockwise"),O=a.get("roseType"),Q=a.get("stillShowZeroSum"),Z=i.getDataExtent(s);Z[0]=0;var P=w?1:-1,T=[p,m],J=P*h/2;hn(T,!w),p=T[0],m=T[1];var z=wa(a);z.startAngle=p,z.endAngle=m,z.clockwise=w;var le=Math.abs(m-p),G=le,se=0,ee=p;if(i.setLayout({viewRect:c,r:l}),i.each(s,function(V,X){var H;if(isNaN(V)){i.setItemLayout(X,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:w,cx:v,cy:y,r0:g,r:O?NaN:l});return}O!=="area"?H=N===0&&Q?L:V*L:H=le/Y,H<_?(H=_,G-=_):se+=V;var f=ee+P*H,b=0,x=0;h>H?(b=ee+P*H/2,x=b):(b=ee+J,x=f-J),i.setItemLayout(X,{angle:H,startAngle:b,endAngle:x,clockwise:w,cx:v,cy:y,r0:g,r:O?mn(V,Z,[g,l]):l}),ee=f}),G<Gt&&Y)if(G<=.001){var he=le/Y;i.each(s,function(V,X){if(!isNaN(V)){var H=i.getItemLayout(X);H.angle=he;var f=0,b=0;he<h?(f=p+P*(X+1/2)*he,b=f):(f=p+P*X*he+J,b=p+P*(X+1)*he-J),H.startAngle=f,H.endAngle=b}})}else L=G/se,ee=p,i.each(s,function(V,X){if(!isNaN(V)){var H=i.getItemLayout(X),f=H.angle===_?_:V*L,b=0,x=0;f<h?(b=ee+P*f/2,x=b):(b=ee+J,x=ee+P*f-J),H.startAngle=b,H.endAngle=x,ee+=P*f}})})}var wa=ra();function cr(e){return{seriesType:e,reset:function(n,o){var a=o.findComponents({mainType:"legend"});if(!(!a||!a.length)){var i=n.getData();i.filterSelf(function(s){for(var c=i.getName(s),u=0;u<a.length;u++)if(!a[u].isSelected(c))return!1;return!0})}}}}var dr=Math.PI/180;function Xt(e,n,o,a,i,s,c,u,v,y){if(e.length<2)return;function l(D){for(var _=D.rB,Y=_*_,N=0;N<D.list.length;N++){var L=D.list[N],w=Math.abs(L.label.y-o),O=a+L.len,Q=O*O,Z=Math.sqrt(Math.abs((1-w*w/Y)*Q)),P=n+(Z+L.len2)*i,T=P-L.label.x,J=L.targetTextWidth-T*i;xa(L,J,!0),L.label.x=P}}function g(D){for(var _={list:[],maxY:0},Y={list:[],maxY:0},N=0;N<D.length;N++)if(D[N].labelAlignTo==="none"){var L=D[N],w=L.label.y>o?Y:_,O=Math.abs(L.label.y-o);if(O>=w.maxY){var Q=L.label.x-n-L.len2*i,Z=a+L.len,P=Math.abs(Q)<Z?Math.sqrt(O*O/(1-Q*Q/Z/Z)):Z;w.rB=P,w.maxY=O}w.list.push(L)}l(_),l(Y)}for(var p=e.length,m=0;m<p;m++)if(e[m].position==="outer"&&e[m].labelAlignTo==="labelLine"){var h=e[m].label.x-y;e[m].linePoints[1][0]+=h,e[m].label.x=y}pn(e,v,v+c)&&g(e)}function vr(e,n,o,a,i,s,c,u){for(var v=[],y=[],l=Number.MAX_VALUE,g=-Number.MAX_VALUE,p=0;p<e.length;p++){var m=e[p].label;yt(e[p])||(m.x<n?(l=Math.min(l,m.x),v.push(e[p])):(g=Math.max(g,m.x),y.push(e[p])))}for(var p=0;p<e.length;p++){var h=e[p];if(!yt(h)&&h.linePoints){if(h.labelStyleWidth!=null)continue;var m=h.label,D=h.linePoints,_=void 0;h.labelAlignTo==="edge"?m.x<n?_=D[2][0]-h.labelDistance-c-h.edgeDistance:_=c+i-h.edgeDistance-D[2][0]-h.labelDistance:h.labelAlignTo==="labelLine"?m.x<n?_=l-c-h.bleedMargin:_=c+i-g-h.bleedMargin:m.x<n?_=m.x-c-h.bleedMargin:_=c+i-m.x-h.bleedMargin,h.targetTextWidth=_,xa(h,_)}}Xt(y,n,o,a,1,i,s,c,u,g),Xt(v,n,o,a,-1,i,s,c,u,l);for(var p=0;p<e.length;p++){var h=e[p];if(!yt(h)&&h.linePoints){var m=h.label,D=h.linePoints,Y=h.labelAlignTo==="edge",N=m.style.padding,L=N?N[1]+N[3]:0,w=m.style.backgroundColor?0:L,O=h.rect.width+w,Q=D[1][0]-D[2][0];Y?m.x<n?D[2][0]=c+h.edgeDistance+O+h.labelDistance:D[2][0]=c+i-h.edgeDistance-O-h.labelDistance:(m.x<n?D[2][0]=m.x+h.labelDistance:D[2][0]=m.x-h.labelDistance,D[1][0]=D[2][0]+Q),D[1][1]=D[2][1]=m.y}}}function xa(e,n,o){if(o===void 0&&(o=!1),e.labelStyleWidth==null){var a=e.label,i=a.style,s=e.rect,c=i.backgroundColor,u=i.padding,v=u?u[1]+u[3]:0,y=i.overflow,l=s.width+(c?0:v);if(n<l||o){var g=s.height;if(y&&y.match("break")){a.setStyle("backgroundColor",null),a.setStyle("width",n-v);var p=a.getBoundingRect();a.setStyle("width",Math.ceil(p.width)),a.setStyle("backgroundColor",c)}else{var m=n-v,h=n<l?m:o?m>e.unconstrainedWidth?null:m:null;a.setStyle("width",h)}var D=a.getBoundingRect();s.width=D.width;var _=(a.style.margin||0)+2.1;s.height=D.height+_,s.y-=(s.height-g)/2}}}function yt(e){return e.position==="center"}function fr(e){var n=e.getData(),o=[],a,i,s=!1,c=(e.get("minShowLabelAngle")||0)*dr,u=n.getLayout("viewRect"),v=n.getLayout("r"),y=u.width,l=u.x,g=u.y,p=u.height;function m(Q){Q.ignore=!0}function h(Q){if(!Q.ignore)return!0;for(var Z in Q.states)if(Q.states[Z].ignore===!1)return!0;return!1}n.each(function(Q){var Z=n.getItemGraphicEl(Q),P=Z.shape,T=Z.getTextContent(),J=Z.getTextGuideLine(),z=n.getItemModel(Q),le=z.getModel("label"),G=le.get("position")||z.get(["emphasis","label","position"]),se=le.get("distanceToLabelLine"),ee=le.get("alignTo"),he=Ce(le.get("edgeDistance"),y),V=le.get("bleedMargin"),X=z.getModel("labelLine"),H=X.get("length");H=Ce(H,y);var f=X.get("length2");if(f=Ce(f,y),Math.abs(P.endAngle-P.startAngle)<c){We(T.states,m),T.ignore=!0,J&&(We(J.states,m),J.ignore=!0);return}if(h(T)){var b=(P.startAngle+P.endAngle)/2,x=Math.cos(b),F=Math.sin(b),R,ie,Se,_e;a=P.cx,i=P.cy;var ye=G==="inside"||G==="inner";if(G==="center")R=P.cx,ie=P.cy,_e="center";else{var ne=(ye?(P.r+P.r0)/2*x:P.r*x)+a,pe=(ye?(P.r+P.r0)/2*F:P.r*F)+i;if(R=ne+x*3,ie=pe+F*3,!ye){var te=ne+x*(H+v-P.r),ae=pe+F*(H+v-P.r),ue=te+(x<0?-1:1)*f,re=ae;ee==="edge"?R=x<0?l+he:l+y-he:R=ue+(x<0?-se:se),ie=re,Se=[[ne,pe],[te,ae],[ue,re]]}_e=ye?"center":ee==="edge"?x>0?"right":"left":x>0?"left":"right"}var De=Math.PI,ve=0,oe=le.get("rotate");if(oa(oe))ve=oe*(De/180);else if(G==="center")ve=0;else if(oe==="radial"||oe===!0){var nt=x<0?-b+De:-b;ve=nt}else if(oe==="tangential"&&G!=="outside"&&G!=="outer"){var Ae=Math.atan2(x,F);Ae<0&&(Ae=De*2+Ae);var rt=F>0;rt&&(Ae=De+Ae),ve=Ae-De}if(s=!!ve,T.x=R,T.y=ie,T.rotation=ve,T.setStyle({verticalAlign:"middle"}),ye){T.setStyle({align:_e});var qe=T.states.select;qe&&(qe.x+=T.x,qe.y+=T.y)}else{var ke=T.getBoundingRect().clone();ke.applyTransform(T.getComputedTransform());var Ge=(T.style.margin||0)+2.1;ke.y-=Ge/2,ke.height+=Ge,o.push({label:T,labelLine:J,position:G,len:H,len2:f,minTurnAngle:X.get("minTurnAngle"),maxSurfaceAngle:X.get("maxSurfaceAngle"),surfaceNormal:new de(x,F),linePoints:Se,textAlign:_e,labelDistance:se,labelAlignTo:ee,edgeDistance:he,bleedMargin:V,rect:ke,unconstrainedWidth:ke.width,labelStyleWidth:T.style.width})}Z.setTextConfig({inside:ye})}}),!s&&e.get("avoidLabelOverlap")&&vr(o,a,i,v,y,p,l,g);for(var D=0;D<o.length;D++){var _=o[D],Y=_.label,N=_.labelLine,L=isNaN(Y.x)||isNaN(Y.y);if(Y){Y.setStyle({align:_.textAlign}),L&&(We(Y.states,m),Y.ignore=!0);var w=Y.states.select;w&&(w.x+=Y.x,w.y+=Y.y)}if(N){var O=_.linePoints;L||!O?(We(N.states,m),N.ignore=!0):(rr(O,_.minTurnAngle),or(O,_.surfaceNormal,_.maxSurfaceAngle),N.setShape({points:O}),Y.__hostTarget.textGuideLineConfig={anchor:new de(O[0][0],O[0][1])})}}}var gr=function(e){_t(n,e);function n(o,a,i){var s=e.call(this)||this;s.z2=2;var c=new Dn;return s.setTextContent(c),s.updateData(o,a,i,!0),s}return n.prototype.updateData=function(o,a,i,s){var c=this,u=o.hostModel,v=o.getItemModel(a),y=v.getModel("emphasis"),l=o.getItemLayout(a),g=Ne(Je(v.getModel("itemStyle"),l,!0),l);if(isNaN(g.startAngle)){c.setShape(g);return}if(s){c.setShape(g);var p=u.getShallow("animationType");u.ecModel.ssr?(vt(c,{scaleX:0,scaleY:0},u,{dataIndex:a,isFrom:!0}),c.originX=g.cx,c.originY=g.cy):p==="scale"?(c.shape.r=l.r0,vt(c,{shape:{r:l.r}},u,a)):i!=null?(c.setShape({startAngle:i,endAngle:i}),vt(c,{shape:{startAngle:l.startAngle,endAngle:l.endAngle}},u,a)):(c.shape.endAngle=l.startAngle,Nt(c,{shape:{endAngle:l.endAngle}},u,a))}else Sn(c),Nt(c,{shape:g},u,a);c.useStyle(o.getItemVisual(a,"style")),_n(c,v);var m=(l.startAngle+l.endAngle)/2,h=u.get("selectedOffset"),D=Math.cos(m)*h,_=Math.sin(m)*h,Y=v.getShallow("cursor");Y&&c.attr("cursor",Y),this._updateLabel(u,o,a),c.ensureState("emphasis").shape=Ne({r:l.r+(y.get("scale")&&y.get("scaleSize")||0)},Je(y.getModel("itemStyle"),l)),Ne(c.ensureState("select"),{x:D,y:_,shape:Je(v.getModel(["select","itemStyle"]),l)}),Ne(c.ensureState("blur"),{shape:Je(v.getModel(["blur","itemStyle"]),l)});var N=c.getTextGuideLine(),L=c.getTextContent();N&&Ne(N.ensureState("select"),{x:D,y:_}),Ne(L.ensureState("select"),{x:D,y:_}),Mn(this,y.get("focus"),y.get("blurScope"),y.get("disabled"))},n.prototype._updateLabel=function(o,a,i){var s=this,c=a.getItemModel(i),u=c.getModel("labelLine"),v=a.getItemVisual(i,"style"),y=v&&v.fill,l=v&&v.opacity;wn(s,xn(c),{labelFetcher:a.hostModel,labelDataIndex:i,inheritColor:y,defaultOpacity:l,defaultText:o.getFormattedLabel(i,"normal")||a.getName(i)});var g=s.getTextContent();s.setTextConfig({position:null,rotation:null}),g.attr({z2:10});var p=o.get(["label","position"]);if(p!=="outside"&&p!=="outer")s.removeTextGuideLine();else{var m=this.getTextGuideLine();m||(m=new na,this.setTextGuideLine(m)),sr(this,ir(c),{stroke:y,opacity:Cn(u.get(["lineStyle","opacity"]),l,1)})}},n}(la),hr=function(e){_t(n,e);function n(){var o=e!==null&&e.apply(this,arguments)||this;return o.ignoreLabelLineUpdate=!0,o}return n.prototype.render=function(o,a,i,s){var c=o.getData(),u=this._data,v=this.group,y;if(!u&&c.count()>0){for(var l=c.getItemLayout(0),g=1;isNaN(l&&l.startAngle)&&g<c.count();++g)l=c.getItemLayout(g);l&&(y=l.startAngle)}if(this._emptyCircleSector&&v.remove(this._emptyCircleSector),c.count()===0&&o.get("showEmptyCircle")){var p=wa(o),m=new la({shape:Ne(Ma(o,i),p)});m.useStyle(o.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=m,v.add(m)}c.diff(u).add(function(h){var D=new gr(c,h,y);c.setItemGraphicEl(h,D),v.add(D)}).update(function(h,D){var _=u.getItemGraphicEl(D);_.updateData(c,h,y),_.off("click"),v.add(_),c.setItemGraphicEl(h,_)}).remove(function(h){var D=u.getItemGraphicEl(h);bn(D,o,h)}).execute(),fr(o),o.get("animationTypeUpdate")!=="expansion"&&(this._data=c)},n.prototype.dispose=function(){},n.prototype.containPoint=function(o,a){var i=a.getData(),s=i.getItemLayout(0);if(s){var c=o[0]-s.cx,u=o[1]-s.cy,v=Math.sqrt(c*c+u*u);return v<=s.r&&v>=s.r0}},n.type="pie",n}($n);const mr=hr;var yr=function(){function e(n,o){this._getDataWithEncodedVisual=n,this._getRawData=o}return e.prototype.getAllNames=function(){var n=this._getRawData();return n.mapArray(n.getName)},e.prototype.containName=function(n){var o=this._getRawData();return o.indexOfName(n)>=0},e.prototype.indexOfName=function(n){var o=this._getDataWithEncodedVisual();return o.indexOfName(n)},e.prototype.getItemVisual=function(n,o){var a=this._getDataWithEncodedVisual();return a.getItemVisual(n,o)},e}();const pr=yr;var br=ra(),Dr=function(e){_t(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.init=function(o){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new pr(Ht(this.getData,this),Ht(this.getRawData,this)),this._defaultLabelLine(o)},n.prototype.mergeOption=function(){e.prototype.mergeOption.apply(this,arguments)},n.prototype.getInitialData=function(){return An(this,{coordDimensions:["value"],encodeDefaulter:sa(kn,this)})},n.prototype.getDataParams=function(o){var a=this.getData(),i=br(a),s=i.seats;if(!s){var c=[];a.each(a.mapDimension("value"),function(v){c.push(v)}),s=i.seats=Tn(c,a.hostModel.get("percentPrecision"))}var u=e.prototype.getDataParams.call(this,o);return u.percent=s[o]||0,u.$vars.push("percent"),u},n.prototype._defaultLabelLine=function(o){Yn(o,"labelLine",["show"]);var a=o.labelLine,i=o.emphasis.labelLine;a.show=a.show&&o.label.show,i.show=i.show&&o.emphasis.label.show},n.type="series.pie",n.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},n}(Ln);const Sr=Dr;function _r(e){return{seriesType:e,reset:function(n,o){var a=n.getData();a.filterSelf(function(i){var s=a.mapDimension("value"),c=a.get(s,i);return!(oa(c)&&!isNaN(c)&&c<0)})}}}function Ca(e){e.registerChartView(mr),e.registerSeriesModel(Sr),In("pie",e.registerAction),e.registerLayout(sa(ur,"pie")),e.registerProcessor(cr("pie")),e.registerProcessor(_r("pie"))}ia([ua,Ca,ca,da]);const Mr=ea({components:{VChart:va},props:{transactions:{type:Array,required:!0,default:()=>[]},categories:{type:Array,required:!0,default:()=>[]},dateRange:{type:Object,default:null},currency:{type:String,default:"EUR"},exchangeRates:{type:Object,default:()=>({})}},setup(e){const n=fa(),o=W(!1),a=l=>{const g=e.categories.find(p=>p.id===l);return g?g.name:"Uncategorized"},i=k(()=>{const l={};return e.transactions.forEach(g=>{if(g.transaction_type!=="Ausgabe")return;const p=a(g.category_id),m=e.exchangeRates[e.currency]/(e.exchangeRates[g.currency]||1),h=g.amount*m;l[p]||(l[p]=0),l[p]+=h}),l}),s=k(()=>Object.keys(i.value).length>0),c=k(()=>{const l=i.value,g=Object.values(l).reduce((p,m)=>p+m,0);return Object.entries(l).map(([p,m])=>({name:p,value:parseFloat(m.toFixed(2)),percentage:g>0?parseFloat((m/g*100).toFixed(1)):0})).sort((p,m)=>m.value-p.value)}),u=k(()=>{if(!s.value)return{};const l=n.dark.isActive,g=l?"#ffffff":"#2d3748",p=l?"rgba(30, 30, 30, 0.95)":"rgba(255, 255, 255, 0.95)",m=l?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)",h=l?"#ffffff":"#2d3748",D=l?"#d1d5db":"#6b7280",_=l?"#ffffff":"#2d3748";return{backgroundColor:"transparent",textStyle:{color:g},tooltip:{trigger:"item",formatter:({data:Y})=>`
          <div class="custom-tooltip" style="color: ${h}">
            <strong>${Y.name}</strong><br/>
            ${Y.value} ${e.currency}<br/>
            <small>${Y.percentage}% of total</small>
          </div>
        `,backgroundColor:p,borderColor:m,textStyle:{color:h},extraCssText:"box-shadow: 0 4px 20px rgba(0,0,0,0.15); border-radius: 8px; padding: 12px;"},legend:{orient:"vertical",right:20,top:"center",textStyle:{color:D,fontSize:12},itemGap:15,formatter:Y=>{const N=c.value.find(L=>L.name===Y);return N?`${Y} (${N.percentage}%)`:Y}},series:[{name:"Expenses by Category",type:"pie",radius:["45%","75%"],center:["35%","50%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:8,borderColor:l?"#374151":"#fff",borderWidth:3,shadowColor:l?"rgba(0, 0, 0, 0.3)":"rgba(0, 0, 0, 0.1)",shadowBlur:8,shadowOffsetX:2,shadowOffsetY:2},label:{show:!1,position:"center",formatter:`{b}
{c} `+e.currency+`
({d}%)`,fontSize:14,fontWeight:"bold",color:_},emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold",formatter:`{b}
{c} `+e.currency,color:_},itemStyle:{shadowColor:l?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.3)",shadowBlur:12,shadowOffsetX:4,shadowOffsetY:4}},labelLine:{show:!1},data:c.value.map(Y=>({name:Y.name,value:Y.value,percentage:Y.percentage,itemStyle:{color:v(Y.name),borderColor:l?"#374151":"#ffffff"},emphasis:{itemStyle:{borderWidth:4,shadowColor:l?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.3)"}}}))}]}}),v=l=>{const g=["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#fa709a","#fee140","#a8edea","#fed6e3","#ff9a9e","#fecfef","#f6d365","#fda085"],p=Math.abs(y(l))%g.length;return g[p]},y=l=>{let g=0;for(let p=0;p<l.length;p++)g=l.charCodeAt(p)+((g<<5)-g);return g};return $e(()=>e.transactions,()=>{e.transactions.length>0&&(o.value=!0,setTimeout(()=>{o.value=!1},300))},{deep:!0}),{loading:o,hasData:s,categoryBreakdown:c,pieChartOptions:u,getCategoryColor:v}}}),je=e=>(ta("data-v-08baa829"),e=e(),aa(),e),wr={class:"header-content"},xr=je(()=>$("h3",null,"Expense Distribution",-1)),Cr={key:0,class:"date-range"},$r={class:"total-expenses"},Ar=je(()=>$("div",{class:"total-label"},"Total Expenses",-1)),kr={class:"total-amount"},Tr={key:0,class:"chart-container"},Yr={class:"chart-wrapper"},Lr={class:"category-details"},Ir={class:"details-header"},Or=je(()=>$("h4",null,"Category Breakdown",-1)),Pr={class:"summary-stats"},Fr={class:"stat"},Er=je(()=>$("span",{class:"stat-label"},"Categories",-1)),Nr={class:"stat-value"},Hr={class:"categories-list"},qr={class:"category-info"},Vr=je(()=>$("div",{class:"category-color-indicator"},null,-1)),Rr={class:"category-text"},Br={class:"category-name"},zr={class:"category-percentage"},jr={class:"category-amount"},Ur={key:1,class:"empty-state"},Qr={class:"empty-icon"},Zr=je(()=>$("div",{class:"empty-text"},[$("h4",null,"No Expense Data"),$("p",null,"No expense transactions found for the selected period")],-1));function Gr(e,n,o,a,i,s){const c=pt("v-chart");return Le(),ja(ga,{class:"category-pie-chart"},{default:xe(()=>[q(bt,{class:"chart-header"},{default:xe(()=>[$("div",wr,[q(ze,{name:"pie_chart",size:"24px",class:"header-icon"}),$("div",null,[xr,e.dateRange?(Le(),He("p",Cr,ge(e.dateRange.from)+" to "+ge(e.dateRange.to),1)):Ua("",!0)])]),$("div",$r,[Ar,$("div",kr,ge(e.categoryBreakdown.reduce((u,v)=>u+v.value,0).toFixed(2))+" "+ge(e.currency),1)])]),_:1}),q(bt,{class:"chart-content"},{default:xe(()=>[e.hasData?(Le(),He("div",Tr,[$("div",Yr,[q(c,{class:"chart",option:e.pieChartOptions,autoresize:"",loading:e.loading},null,8,["option","loading"])]),$("div",Lr,[$("div",Ir,[Or,$("div",Pr,[$("div",Fr,[Er,$("span",Nr,ge(e.categoryBreakdown.length),1)])])]),$("div",Hr,[(Le(!0),He(Qa,null,Za(e.categoryBreakdown,u=>(Le(),He("div",{key:u.name,class:"category-item",style:Ga({"--category-color":e.getCategoryColor(u.name)})},[$("div",qr,[Vr,$("div",Rr,[$("div",Br,ge(u.name),1),$("div",zr,ge(u.percentage)+"%",1)])]),$("div",jr,ge(u.value)+" "+ge(e.currency),1)],4))),128))])])])):(Le(),He("div",Ur,[$("div",Qr,[q(ze,{name:"pie_chart",size:"64px",color:"grey-4"})]),Zr]))]),_:1})]),_:1})}const Xr=Kt(Mr,[["render",Gr],["__scopeId","data-v-08baa829"]]);ia([ua,On,Ca,Pn,ca,Fn,da]);const Wr=ea({components:{VChart:va,CategoryPieChart:Xr},setup(){const e=fa(),n=Wa(),o=W(!1),a=W([]),i=W([]),s=W([]),c=W(!1),u=W(!0),v=W(null),y=W({}),l=W({from:null,to:null}),g=k(()=>l.value.from&&l.value.to?`${l.value.from} - ${l.value.to}`:"");function p(){const f=new Date,b=new Date(f.getFullYear(),f.getMonth(),1),x=new Date(f.getFullYear(),f.getMonth()+1,0);l.value={from:b.toISOString().split("T")[0],to:x.toISOString().split("T")[0]}}const m=D(),h=W({preferred_currency:"EUR",saldo:1e3});function D(){const f=Ja.getToken();if(!f)return null;try{return console.log("Decoding token:",Lt(f)),Lt(f).id}catch(b){return console.error("Invalid token:",b),null}}const _=()=>{e.dark.set(!e.dark.isActive)},Y=()=>{try{const f=new qt;f.text("Financial Report - Transaction Overview",105,20,{align:"center"}),f.setFontSize(10),f.text(`Date Range: ${l.value.from} to ${l.value.to}`,20,35),f.text(`Currency: ${T.value}`,20,42),f.text(`Generated: ${new Date().toLocaleDateString()}`,20,49);const b=s.value.map(F=>[F.date.split("T")[0],F.description||"No description",L(F.category_id),F.transaction_type==="Einnahme"?"Income":"Expense",`${F.transaction_type==="Einnahme"?"+":"-"}${F.amount} ${F.currency||T.value}`]);Vt(f,{head:[["Date","Description","Category","Type","Amount"]],body:b,startY:60,styles:{fontSize:8},headStyles:{fillColor:[66,133,244]}});const x=f.lastAutoTable.finalY+10;f.setFontSize(12),f.text("Summary",20,x),f.setFontSize(10),f.text(`Total Income: ${z.value.toFixed(2)} ${T.value}`,20,x+8),f.text(`Total Expenses: ${le.value.toFixed(2)} ${T.value}`,20,x+16),f.text(`Net Balance: ${G.value.toFixed(2)} ${T.value}`,20,x+24),f.text(`Budget Usage: ${(ee.value*100).toFixed(1)}%`,20,x+32),f.save(`financial_report_${l.value.from}_to_${l.value.to}.pdf`),e.notify({type:"positive",message:"PDF report successfully generated"})}catch(f){console.error("PDF Export Error:",f),e.notify({type:"negative",message:"Error generating PDF report"})}},N=()=>{try{const f=new qt;f.text("Financial Report - Category Summary",105,20,{align:"center"}),f.setFontSize(10),f.text(`Date Range: ${l.value.from} to ${l.value.to}`,20,35),f.text(`Currency: ${T.value}`,20,42),f.text(`Generated: ${new Date().toLocaleDateString()}`,20,49);const b=w(),x=b.map(R=>[R.name,R.income.toFixed(2),R.expenses.toFixed(2),(R.income-R.expenses).toFixed(2),R.transactionCount]);Vt(f,{head:[["Category","Income","Expenses","Balance","Transactions"]],body:x,startY:60,styles:{fontSize:8},headStyles:{fillColor:[66,133,244]}});const F=f.lastAutoTable.finalY+10;f.setFontSize(12),f.text("Category Overview",20,F),f.setFontSize(10),f.text(`Total Income: ${b.reduce((R,ie)=>R+ie.income,0).toFixed(2)} ${T.value}`,20,F+8),f.text(`Total Expenses: ${b.reduce((R,ie)=>R+ie.expenses,0).toFixed(2)} ${T.value}`,20,F+16),f.text(`Net Balance: ${b.reduce((R,ie)=>R+(ie.income-ie.expenses),0).toFixed(2)} ${T.value}`,20,F+24),f.save(`category_report_${l.value.from}_to_${l.value.to}.pdf`),e.notify({type:"positive",message:"Category PDF report successfully generated"})}catch(f){console.error("Category PDF Export Error:",f),e.notify({type:"negative",message:"Error generating category PDF report"})}},L=f=>{const b=a.value.find(x=>x.id===f);return b?b.name:"Uncategorized"},w=()=>{const f=new Map;return s.value.forEach(b=>{if(!b.amount||isNaN(b.amount))return;const x=b.category_id,F=L(x);f.has(x)||f.set(x,{id:x,name:F,income:0,expenses:0,transactionCount:0});const R=f.get(x);b.transaction_type==="Einnahme"?R.income+=Number(b.amount):R.expenses+=Number(b.amount),R.transactionCount++}),Array.from(f.values()).sort((b,x)=>Math.abs(x.income-x.expenses)-Math.abs(b.income-b.expenses))},O=async()=>{try{const f=await ft.get("https://v6.exchangerate-api.com/v6/1bfd15eb1d48a0a8759f2adf/latest/EUR");y.value=f.data.conversion_rates,y.value[T.value]||(y.value[T.value]=1)}catch(f){console.error("Failed to fetch exchange rates:",f),y.value={EUR:1},T.value!=="EUR"&&(y.value[T.value]=1),e.notify({type:"negative",message:"Failed to update exchange rates. Using default rates."})}},Q=async()=>{u.value=!0;try{const f=await ft.get(`http://localhost:3000/preferences/${m}`);if(f.data&&f.data.length>0){const b=f.data[0];h.value={preferred_currency:b.preferred_currency||"EUR",saldo:parseFloat(b.saldo)||1e3}}await O()}catch(f){console.error("Error fetching user preferences:",f),h.value.preferred_currency="EUR",await O()}finally{u.value=!1}},Z=async()=>{c.value=!0;try{const f=await ft.get(`http://localhost:3000/transactions-with-categories/users/${m}`);i.value=f.data,P()}catch(f){console.error("Error fetching transactions:",f),v.value="Failed to fetch data.",e.notify({type:"negative",message:"Failed to load transaction data"})}finally{c.value=!1}},P=()=>{if(!l.value.from||!l.value.to)return;s.value=i.value.filter(b=>{const x=new Date(b.date).toISOString().split("T")[0];return x>=l.value.from&&x<=l.value.to});const f=new Map;s.value.forEach(b=>{b.category_id&&!f.has(b.category_id)&&f.set(b.category_id,{id:b.category_id,name:b.category_name,description:b.category_description})}),a.value=Array.from(f.values())},T=k(()=>{var f;return((f=h.value)==null?void 0:f.preferred_currency)||"EUR"}),J=k(()=>{const f={};return s.value.forEach(b=>{const x=new Date(b.date).toISOString().split("T")[0];f[x]||(f[x]={date:x,income:0,expense:0,currency:b.currency});const F=y.value[T.value]/(y.value[b.currency]||1);b.transaction_type==="Einnahme"?f[x].income+=b.amount*F:f[x].expense+=b.amount*F}),Object.values(f).sort((b,x)=>new Date(b.date)-new Date(x.date))}),z=k(()=>J.value.reduce((f,b)=>f+b.income,0)),le=k(()=>J.value.reduce((f,b)=>f+b.expense,0)),G=k(()=>z.value-le.value),se=k(()=>y.value[T.value]?h.value.saldo*y.value[T.value]:h.value.saldo),ee=k(()=>se.value<=0?0:Math.min(le.value/se.value,1)),he=k(()=>{var ae;if(!((ae=h.value)!=null&&ae.preferred_currency))return{};const f=T.value,b=[...J.value].sort((ue,re)=>new Date(ue.date)-new Date(re.date));let x=0,F=0,R=0;const ie=[],Se=[],_e=[];b.forEach(ue=>{const re=new Date(ue.date).getTime();x+=ue.income,F+=ue.expense,R=x-F,ie.push([re,x]),Se.push([re,F]),_e.push([re,R])});const ye=e.dark.isActive,ne=ye?"#ffffff":"#374151",pe=ye?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",te=ye?"#121212":"#ffffff";return{backgroundColor:te,tooltip:{trigger:"axis",backgroundColor:ye?"#1e1e1e":"#ffffff",borderColor:ye?"#333333":"#e2e8f0",textStyle:{color:ne},formatter:ue=>{const re=new Date(ue[0].value[0]);let De=`<div style="color: ${ne}">${re.toLocaleDateString()}<br/>`;return ue.forEach(ve=>{De+=`${ve.marker} ${ve.seriesName}: ${ve.value[1].toFixed(2)} ${f}<br/>`}),De+="</div>",De}},xAxis:{type:"time",axisLabel:{color:ne,formatter:ue=>{const re=new Date(ue);return`${re.getFullYear()}-${(re.getMonth()+1).toString().padStart(2,"0")}-${re.getDate().toString().padStart(2,"0")}`}},axisLine:{lineStyle:{color:pe}},splitLine:{lineStyle:{color:pe,type:"dashed"}}},yAxis:{type:"value",name:`Amount (${f})`,nameTextStyle:{color:ne},axisLabel:{color:ne},axisLine:{lineStyle:{color:pe}},splitLine:{lineStyle:{color:pe,type:"dashed"}}},series:[{name:"Cumulative Income",type:"line",data:ie,itemStyle:{color:"#10b981"},lineStyle:{width:3},symbol:"circle",symbolSize:6,smooth:!1},{name:"Cumulative Expense",type:"line",data:Se,itemStyle:{color:"#ef4444"},lineStyle:{width:3},symbol:"circle",symbolSize:6,smooth:!1},{name:"Running Balance",type:"line",data:_e,itemStyle:{color:"#3b82f6"},lineStyle:{width:4},symbol:"circle",symbolSize:8,smooth:!1}],dataZoom:[{type:"slider",start:0,end:100,backgroundColor:te,dataBackground:{lineStyle:{color:pe},areaStyle:{color:pe}},borderColor:pe,textStyle:{color:ne}}],legend:{textStyle:{color:ne}}}});$e(()=>{var f;return(f=h.value)==null?void 0:f.preferred_currency},async f=>{if(f){o.value=!0;try{await O()}finally{o.value=!1}}}),$e(l,f=>{f.from&&f.to&&P()},{deep:!0});function V(){P()}function X(){p()}Ka(async()=>{try{p(),await Q(),await Z(),n.query.saved&&e.notify({type:"positive",message:"Preferences updated successfully!"})}catch(f){console.error("Initialization error:",f)}});const H=k(()=>!u.value);return{dateRange:l,dateRangeString:g,chartOptions:he,updateChart:V,resetToCurrentMonth:X,loading:c,error:v,userPreferences:h,exchangeRates:y,totalIncome:z,totalExpense:le,totalBalance:G,convertedBudget:se,budgetUsagePercentage:ee,loadingPreferences:u,currentCurrency:T,isPreferencesLoaded:H,chartLoading:o,categories:a,transactions:s,exportPDF:Y,exportCategoryPDF:N,toggleDarkMode:_}}}),Ue=e=>(ta("data-v-773561ed"),e=e(),aa(),e),Jr={key:0,class:"modern-dashboard"},Kr={class:"dark-mode-toggle"},eo={class:"dashboard-header"},to=Ue(()=>$("div",{class:"header-content"},[$("h1",null,"Financial Dashboard"),$("p",null,"Real-time insights into your financial health")],-1)),ao={class:"header-actions"},no={class:"quick-stats"},ro={class:"stat-card income"},oo={class:"stat-icon"},lo={class:"stat-content"},so={class:"stat-value"},io=Ue(()=>$("div",{class:"stat-label"},"Total Income",-1)),uo={class:"stat-card expense"},co={class:"stat-icon"},vo={class:"stat-content"},fo={class:"stat-value"},go=Ue(()=>$("div",{class:"stat-label"},"Total Expenses",-1)),ho={class:"stat-card balance"},mo={class:"stat-icon"},yo={class:"stat-content"},po=Ue(()=>$("div",{class:"stat-label"},"Net Balance",-1)),bo={class:"stat-card budget"},Do={class:"stat-content"},So={class:"budget-progress"},_o={class:"progress-header"},Mo=Ue(()=>$("div",{class:"progress-label"},"Budget Usage",-1)),wo={class:"progress-value"},xo={class:"row q-gutter-md items-center controls-row"},Co={class:"col-auto"},$o={class:"chart-container"},Ao=en('<div class="chart-header" data-v-773561ed><h3 data-v-773561ed>Financial Overview</h3><div class="chart-legend" data-v-773561ed><div class="legend-item" data-v-773561ed><div class="legend-color income" data-v-773561ed></div><span data-v-773561ed>Cumulative Income</span></div><div class="legend-item" data-v-773561ed><div class="legend-color expense" data-v-773561ed></div><span data-v-773561ed>Cumulative Expense</span></div><div class="legend-item" data-v-773561ed><div class="legend-color balance" data-v-773561ed></div><span data-v-773561ed>Running Balance</span></div></div></div>',1),ko={class:"chart-wrapper"},To={class:"widgets-grid"},Yo={key:1,class:"q-pa-md flex flex-center",style:{height:"100vh"}},Lo=Ue(()=>$("div",{class:"q-ml-md"},"Loading user preferences...",-1));function Io(e,n,o,a,i,s){const c=pt("v-chart"),u=pt("CategoryPieChart");return e.isPreferencesLoaded?(Le(),He("div",Jr,[$("div",Kr,[q(fe,{round:"",color:e.$q.dark.isActive?"grey-9":"yellow",icon:e.$q.dark.isActive?"dark_mode":"light_mode",class:"toggle-btn",onClick:e.toggleDarkMode,size:"lg"},null,8,["color","icon","onClick"])]),$("div",eo,[to,$("div",ao,[q(fe,{icon:"refresh",round:"",flat:"",onClick:e.fetchAllTransactions},null,8,["onClick"]),q(fe,{icon:"download",round:"",flat:"",onClick:e.exportPDF},null,8,["onClick"]),q(fe,{icon:"pie_chart",round:"",flat:"",onClick:e.exportCategoryPDF},null,8,["onClick"])])]),$("div",no,[$("div",ro,[$("div",oo,[q(ze,{name:"trending_up"})]),$("div",lo,[$("div",so,ge(e.totalIncome.toFixed(2))+" "+ge(e.currentCurrency),1),io])]),$("div",uo,[$("div",co,[q(ze,{name:"trending_down"})]),$("div",vo,[$("div",fo,ge(e.totalExpense.toFixed(2))+" "+ge(e.currentCurrency),1),go])]),$("div",ho,[$("div",mo,[q(ze,{name:"account_balance"})]),$("div",yo,[$("div",{class:Xa(["stat-value",e.totalBalance>=0?"positive":"negative"])},ge(e.totalBalance.toFixed(2))+" "+ge(e.currentCurrency),3),po])]),$("div",bo,[$("div",Do,[$("div",So,[$("div",_o,[Mo,$("div",wo,ge((e.budgetUsagePercentage*100).toFixed(1))+"% ",1)]),q(tn,{value:e.budgetUsagePercentage,color:e.budgetUsagePercentage>.8?"red":"primary",size:"20px",rounded:"",class:"budget-progress-bar"},null,8,["value","color"])])])])]),q(ga,{class:"controls-card"},{default:xe(()=>[q(bt,null,{default:xe(()=>[$("div",xo,[$("div",Co,[q(ln,{filled:"",modelValue:e.dateRangeString,"onUpdate:modelValue":n[1]||(n[1]=v=>e.dateRangeString=v),label:"Date Range",readonly:"",class:"date-input",dark:e.$q.dark.isActive},{append:xe(()=>[q(ze,{name:"event",class:"cursor-pointer"},{default:xe(()=>[q(tr,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:xe(()=>[q(er,{modelValue:e.dateRange,"onUpdate:modelValue":[n[0]||(n[0]=v=>e.dateRange=v),e.updateChart],range:"",mask:"YYYY-MM-DD",dark:e.$q.dark.isActive},null,8,["modelValue","onUpdate:modelValue","dark"])]),_:1})]),_:1})]),_:1},8,["modelValue","dark"])]),q(vn,{modelValue:e.userPreferences.preferred_currency,"onUpdate:modelValue":[n[2]||(n[2]=v=>e.userPreferences.preferred_currency=v),e.updateChart],options:Object.keys(e.exchangeRates),label:"Currency",class:"col-auto currency-select",loading:e.loadingPreferences,filled:"",dark:e.$q.dark.isActive},null,8,["modelValue","options","loading","onUpdate:modelValue","dark"]),q(fe,{label:"Reset to Current Month",color:"primary",class:"col-auto primary-action",onClick:e.resetToCurrentMonth,outline:""},null,8,["onClick"]),q(fn),q(En,{class:"col-auto primary-action nav-action-group"},{default:xe(()=>[q(fe,{label:"Crypto",color:"secondary",icon:"trending_up",to:"/crypto",outline:""}),q(fe,{label:"Bank Import",color:"deep-purple",icon:"account_balance",to:"/bank-import",outline:""})]),_:1})])]),_:1})]),_:1}),$("div",$o,[Ao,$("div",ko,[q(c,{class:"main-chart",option:e.chartOptions,autoresize:"",loading:e.chartLoading||e.loading},null,8,["option","loading"])])]),$("div",To,[q(u,{transactions:e.transactions,categories:e.categories,"date-range":e.dateRange,currency:e.userPreferences.preferred_currency,"exchange-rates":e.exchangeRates,class:"widget"},null,8,["transactions","categories","date-range","currency","exchange-rates"])])])):(Le(),He("div",Yo,[q(nr,{size:"xl",color:"primary"}),Lo]))}const Uo=Kt(Wr,[["render",Io],["__scopeId","data-v-773561ed"]]);export{Uo as default};

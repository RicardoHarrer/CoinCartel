import{c as je,A as Ge,B as He,C as We,a as O,h as j,G as $,_ as Ye,u as Ze,r as h,E as Je,o as Xe,aM as $e,b as C,d as Q,w as g,f as ee,g as n,j as i,k as x,Q as S,m as G,i as z,N as te,M as ae,K as p,n as H,L as ge,q as et,aE as tt,aF as at,aG as ne,S as nt,s as ot,t as st}from"./index-wRLNoSK_.js";import{Q as V,a as oe}from"./QInput-DsmJXSEa.js";import{u as rt,Q as N}from"./use-quasar-DdmeiJJS.js";import{b as se,g as re}from"./QSelect-Bwf8Y-zP.js";import{Q as it}from"./QForm-ukj-ikqg.js";import{Q as ct}from"./QSpace-BJllQCfW.js";import{Q as lt}from"./QDialog-BYuOmwN6.js";import{Q as dt}from"./QPage-CcoiKmni.js";import{C as ut}from"./ClosePopup-Dpv5Y6cu.js";import{a as W}from"./axios-DnX1qazU.js";import{E as pe}from"./jspdf.es.min-DxpkvOaK.js";import{autoTable as he}from"./jspdf.plugin.autotable-bUJAAMeG.js";const mt=je({name:"QBanner",props:{...Ge,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(u,{slots:m}){const{proxy:{$q:D}}=He(),o=We(u,D),k=O(()=>"q-banner row items-center"+(u.dense===!0?" q-banner--dense":"")+(o.value===!0?" q-banner--dark q-dark":"")+(u.rounded===!0?" rounded-borders":"")),A=O(()=>`q-banner__actions row items-center justify-end col-${u.inlineActions===!0?"auto":"all"}`);return()=>{const c=[j("div",{class:"q-banner__avatar col-auto row items-center self-start"},$(m.avatar)),j("div",{class:"q-banner__content col text-body2"},$(m.default))],b=$(m.action);return b!==void 0&&c.push(j("div",{class:A.value},b)),j("div",{class:k.value+(u.inlineActions===!1&&b!==void 0?" q-banner--top-padding":""),role:"alert"},c)}}}),gt={name:"AustrianBankImport",setup(){const u=rt();Ze();let m=null;const D=h(!1),o=h("other"),k=h({date:new Date().toISOString().split("T")[0],amount:0,transaction_type:"Ausgabe",category_id:null,description:"",payment_method:"Karte"}),A=h([]),c=h([]),b=h(!1),F=h(!1),E=h(""),I=h(null),T=h([]),y=h({min:0,max:5e3}),q=h("date_desc"),ye=[{label:"Einnahme",value:"Einnahme"},{label:"Ausgabe",value:"Ausgabe"}],_e=[{label:"Datum (Neueste zuerst)",value:"date_desc"},{label:"Datum (Ã„lteste zuerst)",value:"date_asc"},{label:"Betrag (HÃ¶chste zuerst)",value:"amount_desc"},{label:"Betrag (Niedrigste zuerst)",value:"amount_asc"}],fe=O(()=>c.value.map(e=>({label:e.name,value:e.id}))),R=h({totalIncome:0,totalExpenses:0,balance:0,categories:[]}),Y=O(()=>{var e;return((e=R.value)==null?void 0:e.categories)||[]}),ie=h(!1),ce=h(null),K=h([{id:"erste",name:"Erste Bank und Sparkassen",format:"Datum;Buchungstext;Betrag",instruction:'Im Online-Banking: "Kontoauszug exportieren" > "CSV Format" auswÃ¤hlen'},{id:"raiffeisen",name:"Raiffeisen Bank",format:"Buchungstag;Valuta;Buchungstext;Betrag",instruction:'Im Raiffeisen Online-Banking: "UmsÃ¤tze exportieren" > CSV'},{id:"bawag",name:"BAWAG PSK",format:"Buchungsdatum;Betrag;Verwendungszweck",instruction:'BAWAG Online-Banking: "Kontoauszug" > "Exportieren" > CSV'},{id:"volksbank",name:"Volksbanken",format:"Datum;Text;Soll;Haben",instruction:"Volksbank Online-Banking: UmsatzÃ¼bersicht exportieren"},{id:"other",name:"Andere Ã¶sterreichische Bank",format:"Datum;Beschreibung;Betrag",instruction:"CSV-Datei mit Datum, Beschreibung und Betrag hochladen"}]),ve=h([{label:"ðŸ’° Einnahme",value:"Einnahme"},{label:"ðŸ’¸ Ausgabe",value:"Ausgabe"}]),be=h([{label:"ðŸ’³ Karte",value:"Karte"},{label:"ðŸ’µ Bar",value:"Bar"},{label:"ðŸ¦ Ãœberweisung",value:"Ãœberweisung"},{label:"ðŸ”„ Dauerauftrag",value:"Dauerauftrag"},{label:"ðŸ“± Online",value:"Online"},{label:"ðŸ¦ Bank",value:"Bank"}]),ke=h([{label:"ðŸ  Miete",amount:-850,category_id:2,transaction_type:"Ausgabe",description:"Monatsmiete",payment_method:"Ãœberweisung",color:"blue"},{label:"ðŸ›’ Einkauf",amount:-120,category_id:1,transaction_type:"Ausgabe",description:"Wocheneinkauf",payment_method:"Karte",color:"green"},{label:"ðŸ’¼ Gehalt",amount:2500,category_id:3,transaction_type:"Einnahme",description:"Monatsgehalt",payment_method:"Ãœberweisung",color:"positive"},{label:"ðŸš— Tanken",amount:-80,category_id:4,transaction_type:"Ausgabe",description:"TankfÃ¼llung",payment_method:"Karte",color:"orange"}]),P=()=>{const e=ee.getToken();if(!e)return null;try{return nt(e).id}catch{return null}},le=W.create({baseURL:"http://localhost:3000"}),de=()=>{const e=ee.getToken();return e?{Authorization:`Bearer ${e}`}:{}},we=()=>{const e=P();if(!e){u.notify({type:"negative",message:"Bitte zuerst einloggen"});return}window.location.href=`http://localhost:3000/api/bank/link?userId=${e}`},ue=async()=>{var e;try{if(!ee.getToken()){D.value=!1;return}const a=await le.get("/api/bank/status",{headers:de()});D.value=!!((e=a.data)!=null&&e.connected)}catch{D.value=!1}},Ce=async()=>{try{const e=await W.get("http://localhost:3000/categories");c.value=e.data}catch(e){console.error("Error fetching categories:",e)}},xe=e=>{const t=K.value.find(a=>a.id===e);return t?t.name:"Unbekannte Bank"},Be=e=>{const t=K.value.find(a=>a.id===e);return t?t.instruction:"CSV-Datei mit Transaktionen hochladen"},Se=e=>{const t=K.value.find(a=>a.id===e);return t?t.format:"Datum;Beschreibung;Betrag"},M=e=>{const t=c.value.find(a=>a.id===e);return t?t.name:"Unkategorisiert"},Z=O(()=>{let e=[...A.value];if(E.value){const t=E.value.toLowerCase();e=e.filter(a=>{var r;return((r=a.description)==null?void 0:r.toLowerCase().includes(t))||M(a.category_id).toLowerCase().includes(t)})}switch(I.value&&(e=e.filter(t=>t.transaction_type===I.value)),T.value.length>0&&(e=e.filter(t=>T.value.includes(t.category_id))),e=e.filter(t=>t.amount>=y.value.min&&t.amount<=y.value.max),q.value){case"date_asc":e.sort((t,a)=>new Date(t.date)-new Date(a.date));break;case"date_desc":e.sort((t,a)=>new Date(a.date)-new Date(t.date));break;case"amount_asc":e.sort((t,a)=>t.amount-a.amount);break;case"amount_desc":e.sort((t,a)=>a.amount-t.amount);break}return e}),J=()=>{const e=Z.value,t={totalIncome:0,totalExpenses:0,balance:0,categories:[]};if(!e||e.length===0){R.value=t;return}const a=new Map;e.forEach(r=>{if(!r.amount||isNaN(r.amount)){console.warn("Skipping transaction with invalid amount:",r);return}const s=r.category_id,l=M(s);a.has(s)||a.set(s,{id:s,name:l,income:0,expenses:0,netAmount:0,transactionCount:0,transactions:[]});const d=a.get(s);r.transaction_type==="Einnahme"?(d.income+=Number(r.amount),t.totalIncome+=Number(r.amount)):(d.expenses+=Number(r.amount),t.totalExpenses+=Number(r.amount)),d.netAmount=d.income-d.expenses,d.transactionCount++,d.transactions.push(r)}),t.categories=Array.from(a.values()).sort((r,s)=>Math.abs(s.netAmount)-Math.abs(r.netAmount)),t.balance=t.totalIncome-t.totalExpenses,R.value=t};Je([E,I,T,y,q],()=>{J()});const De=e=>{if(!e||e.length===0)return;const t=e[0];if(t.size>5*1024*1024){u.notify({type:"negative",message:"Datei zu groÃŸ. Maximal 5MB erlaubt.",timeout:5e3});return}const a=new FileReader;a.onload=async r=>{F.value=!0;try{let s=r.target.result;const l=Ee(s,o.value);if(l.length===0){u.notify({type:"warning",message:"Keine gÃ¼ltigen Transaktionen in der CSV-Datei gefunden.",timeout:5e3});return}const d=l.filter(_=>_.transaction_type==="Einnahme").reduce((_,L)=>_+Number(L.amount),0),v=l.filter(_=>_.transaction_type==="Ausgabe").reduce((_,L)=>_+Number(L.amount),0);let B=0,w=0;for(const _ of l)try{await Ve(_),B++}catch(L){console.error("Error saving transaction:",L),w++}u.notify({type:B>0?"positive":"warning",message:`${B} Transaktionen importiert (Einnahmen: ${X(d)}, Ausgaben: ${X(v)})${w>0?`, ${w} Fehler`:""}`,timeout:6e3}),U()}catch(s){console.error("Error parsing CSV:",s),u.notify({type:"negative",message:"Fehler beim Import der CSV-Datei. Bitte Format Ã¼berprÃ¼fen.",timeout:5e3})}finally{F.value=!1}},a.readAsText(t,"UTF-8")},Ee=(e,t)=>{const a=e.split(`
`).filter(s=>s.trim()),r=[];for(let s=0;s<a.length;s++)try{if(s===0&&a[s].toLowerCase().includes("datum")&&a[s].toLowerCase().includes("betrag"))continue;let l=a[s].trim();l.startsWith('"')&&l.endsWith('"')&&(l=l.slice(1,-1));const d=[];let v="",B=!1;for(let w of l)w==='"'?B=!B:w===";"&&!B?(d.push(v.trim()),v=""):v+=w;if(d.push(v.trim()),d.length>=3){const w=Te(d,t,!0);if(w!==0){const _={date:Ie(d[0],t),amount:Math.abs(w),description:me(d,t),transaction_type:w>0?"Einnahme":"Ausgabe",category_id:Ae(me(d,t)),payment_method:"Bank",currency:"EUR"};_.date&&_.amount>0&&_.description&&r.push(_)}}}catch(l){console.warn("Skipping invalid CSV line:",a[s],l)}return r},Ie=(e,t)=>{if(!e)return null;if(e=e.replace(/"/g,""),e.includes(".")){const a=e.split(".");if(a.length===3){const[r,s,l]=a.map(v=>v.trim());return`${l.length===2?`20${l}`:l}-${s.padStart(2,"0")}-${r.padStart(2,"0")}`}}return e.match(/^\d{4}-\d{2}-\d{2}$/)?e:null},Te=(e,t,a=!1)=>{for(let r=e.length-1;r>=0;r--){let s=e[r];if(!s||(s=s.replace(/"/g,"").trim(),!s.match(/\d/)))continue;let l=s.startsWith("-")||s.includes(" -")||s.toLowerCase().includes("soll"),d=s.replace(/[â‚¬$]/g,"").replace(/\s/g,"");d.match(/^\d{1,3}(\.\d{3})*,\d{2}$/)?d=d.replace(/\./g,"").replace(",","."):d.match(/^\d+,\d{2}$/)?d=d.replace(",","."):d.match(/^\d+(\.\d+)?$/),d=d.replace(/[^\d.-]/g,"");const v=Number(d);if(isNaN(v)||v===0)continue;const B=l?-Math.abs(v):Math.abs(v);return a?B:Math.abs(B)}return 0},me=(e,t)=>{const a=[];for(let r=1;r<e.length-1;r++)if(e[r]&&e[r].trim()){const s=e[r].replace(/"/g,"").trim();!s.match(/^-?\d+([.,]\d+)?$/)&&!s.match(/^\d{1,2}\.\d{1,2}\.\d{2,4}$/)&&s.length>1&&a.push(s)}if(a.length>0)return a.reduce((s,l)=>l.length>s.length?l:s,"").substring(0,100);for(let r=1;r<e.length;r++)if(e[r]&&e[r].trim()){const s=e[r].replace(/"/g,"").trim();if(!s.match(/^-?\d+([.,]\d+)?$/))return s.substring(0,100)||"Banktransaktion"}return"Banktransaktion"},Ae=e=>{const t=e.toLowerCase(),a=[{keywords:["billa","spar","hofer","lidl","merkur","mpreis","interspar","penny","unimarkt","dm ","bipa"],category_id:1},{keywords:["miete","wohnung","hausverwaltung","immobilie","hausgeld","wohnbau","genossenschaft"],category_id:2},{keywords:["gehalt","lohn","entgelt","salary","payroll","arbeitsentgelt"],category_id:3},{keywords:["tank","omv","shell","jet","aral","bp","agip","avanti","eneco","tankstelle"],category_id:4},{keywords:["restaurant","gasthaus","wirtshaus","cafe","bÃ¤ckerei","mcdonalds","burger","pizza","dÃ¶ner","kebab"],category_id:5},{keywords:["energie","strom","wien energie","kelag","verbund","evn","linz strom","gas","fernwÃ¤rme"],category_id:6},{keywords:["handy","a1","drei","telekom","t-mobile","mobilkom","hot","yesss","telefon","internet"],category_id:7},{keywords:["apotheke","arzt","krankenhaus","doktor","praxis","spital","pharmacy","medizin"],category_id:8},{keywords:["kino","theater","konzert","festival","museum","ausstellung","kino","film"],category_id:9},{keywords:["h&m","c&a","mango","zara","kik","peek","cloppenburg","kleidung","mode","bekleidung"],category_id:10}];for(const r of a)if(r.keywords.some(s=>t.includes(s)))return r.category_id;return 9},Ve=async e=>{const t=P();if(!t)throw new Error("User not authenticated");const a={userId:t,categoryId:e.category_id,amount:Number(e.amount),transactionType:e.transaction_type,currency:e.currency,date:e.date+"T00:00:00",description:e.description};return(await W.post("http://localhost:3000/transactions",a)).data},Fe=async()=>{var t,a;const e=P();if(!e){u.notify({type:"negative",message:"Bitte einloggen um Transaktionen zu speichern"});return}b.value=!0;try{const r={userId:e,categoryId:k.value.category_id,amount:Math.abs(Number(k.value.amount)),transactionType:k.value.transaction_type,currency:"EUR",date:k.value.date+"T00:00:00",description:k.value.description};await W.post("http://localhost:3000/transactions",r),u.notify({type:"positive",message:"Transaktion erfolgreich gespeichert",icon:"check"}),k.value={date:new Date().toISOString().split("T")[0],amount:0,transaction_type:"Ausgabe",category_id:null,description:"",payment_method:"Karte"},U()}catch(r){console.error("Error adding transaction:",r),u.notify({type:"negative",message:"Fehler beim Speichern der Transaktion: "+(((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message)})}finally{b.value=!1}},ze=e=>{k.value={date:new Date().toISOString().split("T")[0],amount:Math.abs(e.amount),transaction_type:e.transaction_type,category_id:e.category_id,description:e.description,payment_method:e.payment_method}},U=async()=>{const e=P();if(e)try{const t=await le.get(`/api/bank/users/${e}?limit=100&sync=true`,{headers:de()});A.value=t.data.map(a=>({...a,amount:Number(a.amount)||0,date:a.date.split("T")[0]})),J()}catch(t){console.error("Error fetching transactions:",t),A.value=[],J()}},Ne=()=>{E.value="",I.value=null,T.value=[],y.value={min:0,max:5e3},q.value="date_desc"},Me=e=>{ce.value=e,ie.value=!0},Ue=()=>{try{const e=["Datum","Beschreibung","Kategorie","Typ","Betrag"],t=Z.value.map(l=>({date:l.date,description:l.description,category:M(l.category_id),type:l.transaction_type==="Einnahme"?"Einnahme":"Ausgabe",amount:`${l.transaction_type==="Einnahme"?"+":"-"}${l.amount} ${l.currency||"â‚¬"}`}));let a=e.join(";")+`
`;t.forEach(l=>{a+=Object.values(l).map(d=>`"${d}"`).join(";")+`
`});const r=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(r),s.download=`transaktionen_${new Date().toISOString().slice(0,10)}.csv`,s.click(),u.notify({type:"positive",message:"CSV erfolgreich exportiert"})}catch(e){console.error(e),u.notify({type:"negative",message:"Fehler beim CSV-Export"})}},Le=()=>{try{const e=new pe;e.text("Transaktionsbericht",105,20,{align:"center"});const t=Z.value.map(a=>[a.date,a.description||"Keine Beschreibung",M(a.category_id),a.transaction_type==="Einnahme"?"Einnahme":"Ausgabe",`${a.amount} ${a.currency||"â‚¬"}`]);he(e,{head:[["Datum","Beschreibung","Kategorie","Typ","Betrag"]],body:t,startY:30}),e.save(`transaktionen_${new Date().toISOString().slice(0,10)}.pdf`),u.notify({type:"positive",message:"PDF-Bericht erfolgreich generiert"})}catch(e){console.error(e),u.notify({type:"negative",message:"Fehler beim PDF-Export"})}},Qe=()=>{try{const e=["Kategorie","Einnahmen","Ausgaben","Saldo"],t=Y.value.map(l=>({category:l.name,income:l.income.toFixed(2),expenses:l.expenses.toFixed(2),balance:(l.income-l.expenses).toFixed(2)}));let a=e.join(";")+`
`;t.forEach(l=>{a+=Object.values(l).map(d=>`"${d}"`).join(";")+`
`});const r=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(r),s.download=`kategorie_bericht_${new Date().toISOString().slice(0,10)}.csv`,s.click(),u.notify({type:"positive",message:"CSV erfolgreich exportiert"})}catch(e){console.error(e),u.notify({type:"negative",message:"Fehler beim CSV-Export"})}},Oe=()=>{try{const e=new pe;e.text("Kategorie-Zusammenfassung",105,20,{align:"center"});const t=Y.value.map(a=>[a.name,a.income.toFixed(2),a.expenses.toFixed(2),(a.income-a.expenses).toFixed(2)]);he(e,{head:[["Kategorie","Einnahmen","Ausgaben","Saldo"]],body:t,startY:30}),e.save(`kategorie_bericht_${new Date().toISOString().slice(0,10)}.pdf`),u.notify({type:"positive",message:"PDF-Bericht erfolgreich generiert"})}catch(e){console.error(e),u.notify({type:"negative",message:"Fehler beim PDF-Export"})}},qe=e=>new Date(e).toLocaleDateString("de-AT"),X=e=>e==null||isNaN(e)?"0,00":new Intl.NumberFormat("de-AT",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),Re=e=>{let t="";switch(e){case"erste":t=`"Datum";"Buchungstext";"Betrag"
"30.09.2025";"MPREIS FILIALE 1234 WIEN";"-45,67"
"29.09.2025";"GEHALT FIRMA GMBH";"2450,00"`;break;case"raiffeisen":t=`"Buchungstag";"Valuta";"Buchungstext";"Betrag"
"30.09.2025";"30.09.2025";"TANKE SPAR 1234";"-78,90"`;break;case"bawag":t=`"Buchungsdatum";"Betrag";"Verwendungszweck"
"30.09.2025";"-120,50";"BILLA EINKAUF 1234"`;break;case"volksbank":t=`"Datum";"Text";"Soll";"Haben"
"30.09.2025";"ONLINE SHOPPING";"89,99";""`;break;default:t=`"Datum";"Beschreibung";"Betrag"
"30.09.2025";"Beispiel Transaktion";"-99,99"`}const a=new Blob([t],{type:"text/csv;charset=utf-8"}),r=window.URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download=`beispiel_${e}.csv`,s.click(),window.URL.revokeObjectURL(r)},Ke=()=>{u.dark.set(!u.dark.isActive)},Pe=()=>{m&&clearInterval(m),m=setInterval(()=>{D.value&&U()},6e4)};return Xe(async()=>{await Ce(),await ue(),await U(),Pe()}),$e(()=>{m&&clearInterval(m)}),{selectedBank:o,manualTransaction:k,recentTransactions:A,categories:c,savingTransaction:b,importingCSV:F,categorySummary:R,categorySummaries:Y,searchText:E,transactionType:I,selectedCategories:T,amountRange:y,sortOption:q,typeOptions:ye,sortOptions:_e,categoryOptions:fe,showCategoryDialog:ie,activeCategory:ce,austrianBanks:K,transactionTypes:ve,paymentMethods:be,quickTransactions:ke,handleFileUpload:De,addManualTransaction:Fe,openQuickTransaction:ze,getBankName:xe,getBankInstructions:Be,getBankFormat:Se,getCategoryName:M,formatDate:qe,formatCurrency:X,downloadSampleCSV:Re,resetFilters:Ne,openCategoryDialog:Me,exportCSV:Ue,exportPDF:Le,exportCategoryCSV:Qe,exportCategoryPDF:Oe,toggleDarkMode:Ke,connectBank:we,checkBankConnection:ue,fetchRecentTransactions:U,bankConnected:D}}},f=u=>(ot("data-v-cc11aab7"),u=u(),st(),u),pt={class:"bank-import-view"},ht={class:"dark-mode-toggle"},yt={class:"compact-header q-mb-lg"},_t={class:"header-content"},ft=f(()=>n("div",null,[n("h1",{class:"text-h4 text-weight-bold text-dark q-mb-xs"},"ðŸ¦ Bank Import"),n("p",{class:"text-subtitle1 text-grey-7"},"Import transactions from Austrian banks")],-1)),vt={class:"main-grid"},bt={class:"left-column"},kt={class:"section-header"},wt=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Bank Import",-1)),Ct={class:"section-header"},xt=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Quick Actions",-1)),Bt={class:"quick-grid"},St={class:"section-header"},Dt=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Export",-1)),Et={class:"export-grid"},It={class:"right-column"},Tt={class:"section-header"},At=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Manual Entry",-1)),Vt={class:"form-grid"},Ft={class:"form-actions"},zt={class:"section-header"},Nt=f(()=>n("h3",{class:"text-h6 text-weight-medium"},"Category Summary",-1)),Mt={class:"summary-stats q-mb-md"},Ut={class:"stat-item income"},Lt={class:"stat-icon"},Qt={class:"stat-content"},Ot={class:"stat-value text-positive"},qt=f(()=>n("div",{class:"stat-label"},"Income",-1)),Rt={class:"stat-item expense"},Kt={class:"stat-icon"},Pt={class:"stat-content"},jt={class:"stat-value text-negative"},Gt=f(()=>n("div",{class:"stat-label"},"Expenses",-1)),Ht={class:"stat-item balance"},Wt={class:"stat-icon"},Yt={class:"stat-content"},Zt=f(()=>n("div",{class:"stat-label"},"Balance",-1)),Jt={class:"categories-grid"},Xt=["onClick"],$t={class:"category-header"},ea={class:"category-name"},ta={class:"transaction-count"},aa={class:"category-amounts"},na={class:"amount income"},oa={class:"amount expense"},sa={key:0,class:"empty-state"},ra=f(()=>n("div",null,"No category data available",-1)),ia=f(()=>n("div",{class:"text-caption"},"Import transactions to see summary",-1)),ca={class:"dialog-title"},la={class:"dialog-stats"},da={class:"dialog-stat"},ua=f(()=>n("div",{class:"stat-label"},"Income",-1)),ma={class:"stat-value text-positive"},ga={class:"dialog-stat"},pa=f(()=>n("div",{class:"stat-label"},"Expenses",-1)),ha={class:"stat-value text-negative"},ya={class:"dialog-stat"},_a=f(()=>n("div",{class:"stat-label"},"Net",-1)),fa={key:0};function va(u,m,D,o,k,A){return C(),Q(dt,{class:"q-pa-lg bg-page responsive-page-padding"},{default:g(()=>[n("div",pt,[n("div",ht,[i(x,{round:"",color:u.$q.dark.isActive?"grey-9":"yellow-9",icon:u.$q.dark.isActive?"dark_mode":"light_mode",class:"toggle-btn",onClick:o.toggleDarkMode,size:"lg"},null,8,["color","icon","onClick"])]),n("div",yt,[n("div",_t,[i(x,{icon:"arrow_back",flat:"",round:"",dense:"",onClick:m[0]||(m[0]=c=>u.$router.back()),class:"q-mr-sm"}),ft]),i(x,{icon:"refresh",flat:"",round:"",dense:"",onClick:o.fetchRecentTransactions},null,8,["onClick"])]),n("div",vt,[n("div",bt,[i(N,{class:"compact-card"},{default:g(()=>[i(V,{class:"card-section"},{default:g(()=>[n("div",kt,[i(S,{name:"account_balance",size:"20px",class:"text-primary"}),wt]),o.bankConnected?(C(),Q(mt,{key:1,dense:"",rounded:"",class:"bg-positive text-white q-mb-md"},{default:g(()=>[G(" âœ… Bank erfolgreich verbunden ")]),_:1})):(C(),Q(x,{key:0,color:"primary",icon:"account_balance",label:"Bank verbinden (Online)",class:"q-mb-md full-width",onClick:o.connectBank},null,8,["onClick"]))]),_:1})]),_:1}),i(N,{class:"compact-card"},{default:g(()=>[i(V,{class:"card-section"},{default:g(()=>[n("div",Ct,[i(S,{name:"bolt",size:"20px",class:"text-primary"}),xt]),n("div",Bt,[(C(!0),z(ae,null,te(o.quickTransactions,c=>(C(),Q(x,{key:c.label,label:c.label,color:c.color,outline:"",size:"sm",onClick:b=>o.openQuickTransaction(c),class:"quick-btn"},null,8,["label","color","onClick"]))),128))])]),_:1})]),_:1}),i(N,{class:"compact-card"},{default:g(()=>[i(V,{class:"card-section"},{default:g(()=>[n("div",St,[i(S,{name:"download",size:"20px",class:"text-primary"}),Dt]),n("div",Et,[i(x,{color:"primary",icon:"picture_as_pdf",label:"PDF",onClick:o.exportPDF,outline:"",dense:"",class:"export-btn"},null,8,["onClick"]),i(x,{color:"positive",icon:"text_snippet",label:"CSV",onClick:o.exportCSV,outline:"",dense:"",class:"export-btn"},null,8,["onClick"]),i(x,{color:"secondary",icon:"pie_chart",label:"Categories PDF",onClick:o.exportCategoryPDF,outline:"",dense:"",class:"export-btn"},null,8,["onClick"]),i(x,{color:"teal",icon:"analytics",label:"Categories CSV",onClick:o.exportCategoryCSV,outline:"",dense:"",class:"export-btn"},null,8,["onClick"])])]),_:1})]),_:1})]),n("div",It,[i(N,{class:"compact-card"},{default:g(()=>[i(V,{class:"card-section"},{default:g(()=>[n("div",Tt,[i(S,{name:"edit",size:"20px",class:"text-primary"}),At]),i(it,{onSubmit:o.addManualTransaction,class:"compact-form"},{default:g(()=>[n("div",Vt,[i(oe,{filled:"",modelValue:o.manualTransaction.date,"onUpdate:modelValue":m[1]||(m[1]=c=>o.manualTransaction.date=c),label:"Date",type:"date",dense:"",class:"full-width",required:""},null,8,["modelValue"]),i(oe,{filled:"",modelValue:o.manualTransaction.amount,"onUpdate:modelValue":m[2]||(m[2]=c=>o.manualTransaction.amount=c),modelModifiers:{number:!0},label:"Amount (â‚¬)",type:"number",step:"0.01",dense:"",required:""},null,8,["modelValue"]),i(se,{filled:"",modelValue:o.manualTransaction.transaction_type,"onUpdate:modelValue":m[3]||(m[3]=c=>o.manualTransaction.transaction_type=c),options:o.transactionTypes,label:"Type",dense:"",required:"","emit-value":"","map-options":""},null,8,["modelValue","options"]),i(se,{filled:"",modelValue:o.manualTransaction.category_id,"onUpdate:modelValue":m[4]||(m[4]=c=>o.manualTransaction.category_id=c),modelModifiers:{number:!0},options:o.categories,label:"Category","option-label":"name","option-value":"id",dense:"",required:"","emit-value":"","map-options":""},null,8,["modelValue","options"]),i(oe,{filled:"",modelValue:o.manualTransaction.description,"onUpdate:modelValue":m[5]||(m[5]=c=>o.manualTransaction.description=c),label:"Description",dense:"",required:"",class:"full-width"},null,8,["modelValue"]),i(se,{filled:"",modelValue:o.manualTransaction.payment_method,"onUpdate:modelValue":m[6]||(m[6]=c=>o.manualTransaction.payment_method=c),options:o.paymentMethods,label:"Payment Method",dense:"","emit-value":"","map-options":"",class:"full-width"},null,8,["modelValue","options"])]),n("div",Ft,[i(x,{label:"Save Transaction",type:"submit",color:"primary",icon:"save",loading:o.savingTransaction,class:"save-btn",dense:""},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),i(N,{class:"compact-card"},{default:g(()=>[i(V,{class:"card-section"},{default:g(()=>[n("div",zt,[i(S,{name:"pie_chart",size:"20px",class:"text-primary"}),Nt]),n("div",Mt,[n("div",Ut,[n("div",Lt,[i(S,{name:"north",size:"18px"})]),n("div",Qt,[n("div",Ot," +"+p(o.formatCurrency(o.categorySummary.totalIncome)),1),qt])]),n("div",Rt,[n("div",Kt,[i(S,{name:"south",size:"18px"})]),n("div",Pt,[n("div",jt," -"+p(o.formatCurrency(o.categorySummary.totalExpenses)),1),Gt])]),n("div",Ht,[n("div",Wt,[i(S,{name:"account_balance_wallet",size:"18px"})]),n("div",Yt,[n("div",{class:H(["stat-value",o.categorySummary.balance>=0?"text-positive":"text-negative"])},p(o.categorySummary.balance>=0?"+":"")+p(o.formatCurrency(o.categorySummary.balance)),3),Zt])])]),n("div",Jt,[(C(!0),z(ae,null,te(o.categorySummaries,c=>(C(),z("div",{key:c.id,class:"category-card",onClick:b=>o.openCategoryDialog(c)},[n("div",$t,[n("div",ea,p(c.name),1),n("div",ta,p(c.transactionCount),1)]),n("div",aa,[n("div",na,"+"+p(o.formatCurrency(c.income)),1),n("div",oa,"-"+p(o.formatCurrency(c.expenses)),1),n("div",{class:H(["amount net",c.netAmount>=0?"positive":"negative"])},p(c.netAmount>=0?"+":"")+p(o.formatCurrency(c.netAmount)),3)])],8,Xt))),128))]),o.categorySummaries.length===0?(C(),z("div",sa,[i(S,{name:"pie_chart",size:"32px",color:"grey-4"}),ra,ia])):ge("",!0)]),_:1})]),_:1})])]),i(lt,{modelValue:o.showCategoryDialog,"onUpdate:modelValue":m[7]||(m[7]=c=>o.showCategoryDialog=c)},{default:g(()=>[i(N,{class:"dialog-card"},{default:g(()=>[i(V,{class:"dialog-header"},{default:g(()=>{var c;return[n("div",ca,p((c=o.activeCategory)==null?void 0:c.name),1),i(ct),et(i(x,{icon:"close",flat:"",round:"",dense:""},null,512),[[ut]])]}),_:1}),i(V,null,{default:g(()=>{var c,b,F,E,I;return[n("div",la,[n("div",da,[ua,n("div",ma," +"+p(o.formatCurrency(((c=o.activeCategory)==null?void 0:c.income)||0)),1)]),n("div",ga,[pa,n("div",ha," -"+p(o.formatCurrency(((b=o.activeCategory)==null?void 0:b.expenses)||0)),1)]),n("div",ya,[_a,n("div",{class:H(["stat-value",(((F=o.activeCategory)==null?void 0:F.netAmount)||0)>=0?"text-positive":"text-negative"])},p((((E=o.activeCategory)==null?void 0:E.netAmount)||0)>=0?"+":"")+p(o.formatCurrency(((I=o.activeCategory)==null?void 0:I.netAmount)||0)),3)])]),i(tt,{separator:"",dense:""},{default:g(()=>{var T;return[(C(!0),z(ae,null,te(((T=o.activeCategory)==null?void 0:T.transactions)||[],y=>(C(),Q(at,{key:y.id,class:"transaction-item"},{default:g(()=>[i(ne,{avatar:""},{default:g(()=>[i(S,{name:y.transaction_type==="Einnahme"?"arrow_upward":"arrow_downward",color:y.transaction_type==="Einnahme"?"positive":"negative",size:"sm"},null,8,["name","color"])]),_:2},1024),i(ne,null,{default:g(()=>[i(re,{class:"transaction-description"},{default:g(()=>[G(p(y.description||"No description"),1)]),_:2},1024),i(re,{caption:""},{default:g(()=>[G(p(o.formatDate(y.date))+" ",1),y.payment_method?(C(),z("span",fa,"â€¢ "+p(y.payment_method),1)):ge("",!0)]),_:2},1024)]),_:2},1024),i(ne,{side:""},{default:g(()=>[i(re,{class:H([y.transaction_type==="Einnahme"?"text-positive":"text-negative","text-weight-bold"])},{default:g(()=>[G(p(y.transaction_type==="Einnahme"?"+":"-")+p(o.formatCurrency(y.amount)),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024))),128))]}),_:1})]}),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const Va=Ye(gt,[["render",va],["__scopeId","data-v-cc11aab7"]]);export{Va as default};

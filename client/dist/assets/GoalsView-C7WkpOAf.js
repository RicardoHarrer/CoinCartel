import{c as j,aD as be,aE as ye,aF as _e,B as se,ay as $e,aG as O,aH as ke,a as c,G as we,h as V,ai as xe,_ as M,I as U,b as _,d as N,w as r,j as a,g as t,K as m,k as C,l as qe,Y as De,W as oe,X as P,Q as q,m as T,L as F,n as Se,s as Y,t as H,r as D,E as le,i as A,M as re,N as ne,q as X,av as Ce,au as Ae,al as Ge,aI as Ve,J as K,o as Ne,aJ as Fe,V as Qe,f as Be,S as Ie}from"./index-CzvB3Xry.js";import{Q as k,a as z}from"./QInput-DDS2Gl1d.js";import{Q as w,u as ee}from"./use-quasar-OXbVvlBM.js";import{Q as J}from"./QDialog-DQzS5NCS.js";import{Q as ie}from"./QCardActions-B6Nt_qTV.js";import{Q as ze}from"./QPage-Bfa9833q.js";import{C as te}from"./ClosePopup-BtqDtvPP.js";import{Q as Te,b as Ze}from"./QSelect-sxqXvIeA.js";import{Q as ce}from"./QLinearProgress-DUAHWCkq.js";import{Q as Pe}from"./QForm-D2LgQEW0.js";const R=j({name:"QTab",props:be,emits:ye,setup(e,{slots:o,emit:d}){const{renderTab:g}=_e(e,o,d);return()=>g("div")}}),Ee={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function je(){const{props:e,proxy:{$q:o}}=se(),d=$e(ke,O);if(d===O)return console.error("QPageSticky needs to be child of QLayout"),O;const g=c(()=>{const f=e.position;return{top:f.indexOf("top")!==-1,right:f.indexOf("right")!==-1,bottom:f.indexOf("bottom")!==-1,left:f.indexOf("left")!==-1,vertical:f==="top"||f==="bottom",horizontal:f==="left"||f==="right"}}),n=c(()=>d.header.offset),h=c(()=>d.right.offset),s=c(()=>d.footer.offset),p=c(()=>d.left.offset),b=c(()=>{let f=0,x=0;const l=g.value,v=o.lang.rtl===!0?-1:1;l.top===!0&&n.value!==0?x=`${n.value}px`:l.bottom===!0&&s.value!==0&&(x=`${-s.value}px`),l.left===!0&&p.value!==0?f=`${v*p.value}px`:l.right===!0&&h.value!==0&&(f=`${-v*h.value}px`);const $={transform:`translate(${f}, ${x})`};return e.offset&&($.margin=`${e.offset[1]}px ${e.offset[0]}px`),l.vertical===!0?(p.value!==0&&($[o.lang.rtl===!0?"right":"left"]=`${p.value}px`),h.value!==0&&($[o.lang.rtl===!0?"left":"right"]=`${h.value}px`)):l.horizontal===!0&&(n.value!==0&&($.top=`${n.value}px`),s.value!==0&&($.bottom=`${s.value}px`)),$}),i=c(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function y(f){const x=we(f.default);return V("div",{class:i.value,style:b.value},e.expand===!0?x:[V("div",x)])}return{$layout:d,getStickyContent:y}}const Me=j({name:"QPageSticky",props:Ee,setup(e,{slots:o}){const{getStickyContent:d}=je();return()=>d(o)}}),Ue=["top","middle","bottom"],E=j({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>Ue.includes(e)}},setup(e,{slots:o}){const d=c(()=>e.align!==void 0?{verticalAlign:e.align}:null),g=c(()=>{const n=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(n!==void 0?` text-${n}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>V("div",{class:g.value,style:d.value,role:"status","aria-label":e.label},xe(o.default,e.label!==void 0?[e.label]:[]))}}),Le=U({name:"GoalCard",props:{goal:{type:Object,required:!0}},emits:["click","edit","delete","menu"],setup(e){const o=c(()=>{switch(e.goal.status){case"completed":return"positive";case"overdue":return"negative";default:return"primary"}}),d=c(()=>e.goal.current_amount/e.goal.target_amount*100),g=c(()=>{switch(e.goal.status){case"completed":return"check_circle";case"overdue":return"warning";default:return"schedule"}}),n=c(()=>{switch(e.goal.status){case"completed":return"Erreicht";case"overdue":return"ÃœberfÃ¤llig";default:return"In Bearbeitung"}}),h=c(()=>e.goal.status==="completed"?"positive":"primary"),s=c(()=>e.goal.status==="overdue"?"goal-card-overdue":"");return{statusColor:o,statusIcon:g,statusText:n,progressColor:h,statusClass:s,formatDate:i=>new Date(i).toLocaleDateString("de-DE"),progressPercentage:d,formatNumber:i=>new Intl.NumberFormat("de-DE").format(i)}}}),Oe=e=>(Y("data-v-73109ccf"),e=e(),H(),e),Ke={class:"row items-center no-wrap q-mb-sm"},Je={class:"col"},Re={class:"text-h6 text-weight-bold text-primary"},We={class:"col-auto"},Ye={class:"row q-gutter-xs q-mb-md"},He={class:"q-mb-md"},Xe={class:"row justify-between items-center q-mb-xs"},et=Oe(()=>t("div",{class:"text-caption text-grey-6"},"Fortschritt",-1)),tt={class:"text-caption text-weight-bold text-primary"},at={class:"row justify-between"},ot={class:"text-caption text-grey-6"},st={class:"text-caption text-grey-6"},lt={class:"row items-center justify-between"},rt={class:"row items-center"},nt={class:"text-caption text-grey-6"};function it(e,o,d,g,n,h){return _(),N(w,{class:Se(["goal-card cursor-pointer bg-card",e.statusClass]),onClick:o[3]||(o[3]=s=>e.$emit("click",e.goal))},{default:r(()=>[a(k,{class:"q-pa-md"},{default:r(()=>[t("div",Ke,[t("div",Je,[t("div",Re,m(e.goal.title),1)]),t("div",We,[a(C,{flat:"",round:"",icon:"more_vert",size:"sm",color:"grey-6",onClick:o[2]||(o[2]=qe(s=>e.$emit("menu",e.goal),["stop"]))},{default:r(()=>[a(Te,{"auto-close":"",class:"goal-card-menu"},{default:r(()=>[a(De,{class:"goal-menu-list"},{default:r(()=>[a(oe,{clickable:"",onClick:o[0]||(o[0]=s=>e.$emit("edit",e.goal)),class:"goal-edit-item"},{default:r(()=>[a(P,{avatar:""},{default:r(()=>[a(q,{name:"edit",size:"xs"})]),_:1}),a(P,null,{default:r(()=>[T("Bearbeiten")]),_:1})]),_:1}),a(oe,{clickable:"",onClick:o[1]||(o[1]=s=>e.$emit("delete",e.goal)),class:"goal-delete-item"},{default:r(()=>[a(P,{avatar:""},{default:r(()=>[a(q,{name:"delete",size:"xs"})]),_:1}),a(P,null,{default:r(()=>[T("LÃ¶schen")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),t("div",Ye,[a(E,{color:e.statusColor,icon:e.statusIcon,class:"text-caption text-weight-medium"},{default:r(()=>[T(m(e.statusText),1)]),_:1},8,["color","icon"]),e.goal.category_name?(_(),N(E,{key:0,outline:"",color:"accent",class:"text-caption"},{default:r(()=>[T(m(e.goal.category_name),1)]),_:1})):F("",!0)]),t("div",He,[t("div",Xe,[et,t("div",tt,m(e.progressPercentage.toFixed(1))+"% ",1)]),a(ce,{value:e.goal.progress_percentage/100,color:e.progressColor,size:"8px",rounded:"",class:"q-mb-xs"},null,8,["value","color"]),t("div",at,[t("div",ot," â‚¬"+m(e.formatNumber(e.goal.current_amount)),1),t("div",st," â‚¬"+m(e.formatNumber(e.goal.target_amount)),1)])]),t("div",lt,[t("div",rt,[a(q,{name:"event",size:"xs",color:"grey-6",class:"q-mr-xs"}),t("div",nt," Bis "+m(e.formatDate(e.goal.target_date)),1)]),a(q,{name:"trending_up",size:"sm",color:e.progressPercentage>=50?"positive":"primary"},null,8,["color"])])]),_:1})]),_:1},8,["class"])}const ct=M(Le,[["render",it],["__scopeId","data-v-73109ccf"]]),dt=U({name:"GoalCreator",props:{userId:{type:Number,required:!0},editGoal:{type:Object,default:null}},emits:["saved","cancel"],setup(e,{emit:o}){const d=ee(),g=D(!1),n=D({title:"",target_amount:"",current_amount:"0",target_date:"",category_id:null,description:""}),h=[{title:"Notgroschen",target_amount:3e3,category:"Sparen",description:"3 NettogehÃ¤lter als Sicherheit"},{title:"Urlaubsgeld",target_amount:1500,category:"Sparen",description:"FÃ¼r den nÃ¤chsten Sommerurlaub"},{title:"Smartphone",target_amount:800,category:"Technik",description:"Aktuelles Modell ersetzen"},{title:"Auto-Reparatur",target_amount:1200,category:"Auto",description:"JÃ¤hrliche Wartungskosten"}],s=c(()=>[{label:"Sparen",value:11},{label:"Investition",value:12},{label:"Urlaub",value:13},{label:"Auto",value:14},{label:"Technik",value:15},{label:"Sonstiges",value:16}]),p=c(()=>{if(!n.value.target_amount||!n.value.target_date)return 0;const l=parseFloat(n.value.target_amount),v=parseFloat(n.value.current_amount)||0,$=l-v,B=new Date,I=new Date(n.value.target_date),Q=(I.getFullYear()-B.getFullYear())*12+(I.getMonth()-B.getMonth());return Q>0?($/Q).toFixed(2):$.toFixed(2)}),b=c(()=>{if(!n.value.target_amount)return 0;const l=parseFloat(n.value.target_amount),v=parseFloat(n.value.current_amount)||0;return l>0?v/l*100:0}),i=l=>{const v=s.value.find($=>$.label===l.category);n.value={title:l.title,target_amount:l.target_amount.toString(),current_amount:"0",target_date:y(90),category_id:v?v.value:null,description:l.description}},y=l=>{const v=new Date;return v.setDate(v.getDate()+l),v.toISOString().split("T")[0]},f=l=>new Intl.NumberFormat("de-DE").format(l),x=async()=>{g.value=!0;try{const l=e.editGoal?`http://localhost:3000/api/goals/${e.editGoal.id}`:"http://localhost:3000/api/goals";if((await fetch(l,{method:e.editGoal?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.userId,title:n.value.title,targetAmount:parseFloat(n.value.target_amount),currentAmount:parseFloat(n.value.current_amount)||0,targetDate:n.value.target_date,categoryId:n.value.category_id,description:n.value.description})})).ok)o("saved");else throw new Error("Failed to save goal")}catch{d.notify({type:"negative",message:"Fehler beim Speichern des Ziels"})}finally{g.value=!1}};return le(()=>e.editGoal,l=>{l?n.value={title:l.title,target_amount:l.target_amount.toString(),current_amount:l.current_amount.toString(),target_date:l.target_date.split("T")[0],category_id:l.category_id,description:l.description||""}:n.value={title:"",target_amount:"",current_amount:"0",target_date:"",category_id:null,description:""}},{immediate:!0}),{loading:g,formData:n,goalSuggestions:h,categoryOptions:s,monthlySaving:p,currentProgress:b,applySuggestion:i,submitGoal:x,formatNumber:f}}}),L=e=>(Y("data-v-e1bb05d8"),e=e(),H(),e),ut={class:"text-h5 text-weight-bold text-dark"},mt={key:0,class:"q-mb-lg"},gt=L(()=>t("div",{class:"text-subtitle1 text-weight-medium text-dark q-mb-sm"}," Schnellauswahl ",-1)),vt={class:"row q-col-gutter-sm"},ft={class:"text-caption text-weight-bold text-dark"},pt={class:"text-h6 text-primary"},ht={class:"row q-col-gutter-sm"},bt={class:"col-6"},yt={class:"col-6"},_t=L(()=>t("div",{class:"text-subtitle2 text-weight-medium text-dark q-mb-sm"}," Sparplan ",-1)),$t={class:"row justify-between items-center q-mb-sm"},kt=L(()=>t("div",{class:"text-caption text-grey-7"},"Monatliche Sparrate:",-1)),wt={class:"text-h6 text-primary"},xt={key:0,class:"q-mt-md"},qt={class:"row justify-between items-center q-mb-xs"},Dt=L(()=>t("div",{class:"text-caption text-grey-7"},"Fortschritt:",-1)),St={class:"text-caption text-weight-bold text-primary"},Ct={class:"row justify-end q-gutter-sm q-mt-lg"};function At(e,o,d,g,n,h){return _(),N(w,{class:"creator-card bg-surface"},{default:r(()=>[a(k,{class:"q-pb-none"},{default:r(()=>[t("div",ut,m(e.editGoal?"Ziel bearbeiten":"Neues Sparziel"),1)]),_:1}),a(k,{class:"q-pt-md"},{default:r(()=>[a(Pe,{onSubmit:e.submitGoal,class:"q-gutter-y-md"},{default:r(()=>[e.editGoal?F("",!0):(_(),A("div",mt,[gt,t("div",vt,[(_(!0),A(re,null,ne(e.goalSuggestions,(s,p)=>(_(),A("div",{key:p,class:"col-6"},[a(w,{class:"cursor-pointer suggestion-card bg-card",onClick:b=>e.applySuggestion(s)},{default:r(()=>[a(k,{class:"text-center q-pa-sm"},{default:r(()=>[a(q,{name:"savings",size:"md",color:"primary",class:"q-mb-xs"}),t("div",ft,m(s.title),1),t("div",pt," â‚¬"+m(e.formatNumber(s.target_amount)),1),a(E,{label:s.category,color:"accent"},null,8,["label"])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])])),a(z,{modelValue:e.formData.title,"onUpdate:modelValue":o[0]||(o[0]=s=>e.formData.title=s),label:"Ziel-Titel",placeholder:"z.B. Neues Auto, Urlaub, Notgroschen...",rules:[s=>!!s||"Titel ist erforderlich"],filled:"",class:"input-field",color:"primary",dark:e.$q.dark.isActive},null,8,["modelValue","rules","dark"]),t("div",ht,[t("div",bt,[a(z,{modelValue:e.formData.target_amount,"onUpdate:modelValue":o[1]||(o[1]=s=>e.formData.target_amount=s),label:"Zielbetrag (â‚¬)",type:"number",rules:[s=>!!s||"Zielbetrag ist erforderlich",s=>s>0||"Betrag muss positiv sein"],filled:"",class:"input-field",color:"primary",dark:e.$q.dark.isActive},null,8,["modelValue","rules","dark"])]),t("div",yt,[a(z,{modelValue:e.formData.current_amount,"onUpdate:modelValue":o[2]||(o[2]=s=>e.formData.current_amount=s),label:"Aktueller Betrag (â‚¬)",type:"number",filled:"",class:"input-field",color:"primary",dark:e.$q.dark.isActive},null,8,["modelValue","dark"])])]),a(z,{modelValue:e.formData.target_date,"onUpdate:modelValue":o[3]||(o[3]=s=>e.formData.target_date=s),label:"Ziel-Datum",type:"date",rules:[s=>!!s||"Datum ist erforderlich"],filled:"",class:"input-field",color:"primary",dark:e.$q.dark.isActive},null,8,["modelValue","rules","dark"]),a(Ze,{modelValue:e.formData.category_id,"onUpdate:modelValue":o[4]||(o[4]=s=>e.formData.category_id=s),options:e.categoryOptions,label:"Kategorie","emit-value":"","map-options":"",filled:"",class:"input-field",color:"primary",dark:e.$q.dark.isActive},null,8,["modelValue","options","dark"]),a(z,{modelValue:e.formData.description,"onUpdate:modelValue":o[5]||(o[5]=s=>e.formData.description=s),label:"Beschreibung",type:"textarea",rows:"2",filled:"",class:"input-field",color:"primary",dark:e.$q.dark.isActive},null,8,["modelValue","dark"]),e.formData.target_amount&&e.formData.target_date?(_(),N(w,{key:1,flat:"",class:"bg-info-card"},{default:r(()=>[a(k,{class:"q-pa-md"},{default:r(()=>[_t,t("div",$t,[kt,t("div",wt,"â‚¬"+m(e.monthlySaving),1)]),e.currentProgress>0?(_(),A("div",xt,[t("div",qt,[Dt,t("div",St,m(e.currentProgress.toFixed(1))+"% ",1)]),a(ce,{value:e.currentProgress/100,color:"primary",size:"6px",rounded:""},null,8,["value"])])):F("",!0)]),_:1})]),_:1})):F("",!0),t("div",Ct,[X(a(C,{label:"Abbrechen",color:"grey-6",flat:"",onClick:o[6]||(o[6]=s=>e.$emit("cancel")),class:"cancel-button"},null,512),[[te]]),a(C,{label:e.editGoal?"Aktualisieren":"Erstellen",type:"submit",color:"primary",loading:e.loading,class:"action-button"},null,8,["label","loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})}const Gt=M(dt,[["render",At],["__scopeId","data-v-e1bb05d8"]]),Vt={...Ce,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},W=50,de=2*W,ue=de*Math.PI,Nt=Math.round(ue*1e3)/1e3,Ft=j({name:"QCircularProgress",props:{...Vt,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:o}){const{proxy:{$q:d}}=se(),g=Ae(e),n=c(()=>{const l=(d.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(d.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-l}deg)`:`rotate3d(0, 0, 1, ${l-90}deg)`}}),h=c(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),s=c(()=>de/(1-e.thickness/2)),p=c(()=>`${s.value/2} ${s.value/2} ${s.value} ${s.value}`),b=c(()=>Ge(e.value,e.min,e.max)),i=c(()=>e.max-e.min),y=c(()=>e.thickness/2*s.value),f=c(()=>{const l=(e.max-b.value)/i.value,v=e.rounded===!0&&b.value<e.max&&l<.25?y.value/2*(1-l/.25):0;return ue*l+v});function x({thickness:l,offset:v,color:$,cls:B,rounded:I}){return V("circle",{class:"q-circular-progress__"+B+($!==void 0?` text-${$}`:""),style:h.value,fill:"transparent",stroke:"currentColor","stroke-width":l,"stroke-dasharray":Nt,"stroke-dashoffset":v,"stroke-linecap":I,cx:s.value,cy:s.value,r:W})}return()=>{const l=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&l.push(V("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:W-y.value/2,cx:s.value,cy:s.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&l.push(x({cls:"track",thickness:y.value,offset:0,color:e.trackColor})),l.push(x({cls:"circle",thickness:y.value,offset:f.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const v=[V("svg",{class:"q-circular-progress__svg",style:n.value,viewBox:p.value,"aria-hidden":"true"},l)];return e.showValue===!0&&v.push(V("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},o.default!==void 0?o.default():[V("div",b.value)])),V("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:g.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:b.value},Ve(o.internal,v))}}}),Qt=U({name:"GoalDetails",props:{goal:{type:Object,required:!0}},emits:["close","updated"],setup(e,{emit:o}){const d=ee(),g=D(e.goal.current_amount),n=c(()=>e.goal.current_amount/e.goal.target_amount*100),h=c(()=>e.goal.status==="completed"?"positive":"primary"),s=c(()=>(e.goal.target_amount-e.goal.current_amount).toFixed(2)),p=c(()=>{const l=new Date,$=new Date(e.goal.target_date)-l;return Math.ceil($/(1e3*60*60*24))}),b=c(()=>{const l=e.goal.target_amount-e.goal.current_amount;return p.value>0?(l/p.value).toFixed(2):"0.00"}),i=c(()=>n.value<25?"Du hast einen groÃŸartigen Start! Weiter so! ðŸš€":n.value<50?"Du bist auf dem besten Weg! Bleib dran! ðŸ’ª":n.value<75?"Schon mehr als die HÃ¤lfte geschafft! ðŸ¤©":"Fast geschafft! Das letzte StÃ¼ck ist am schwersten! ðŸŽ¯"),y=l=>new Date(l).toLocaleDateString("de-DE"),f=l=>new Intl.NumberFormat("de-DE").format(l),x=async()=>{try{(await fetch(`http://localhost:3000/api/goals/${e.goal.id}/amount`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentAmount:parseFloat(g.value)})})).ok&&(d.notify({type:"positive",message:"Betrag erfolgreich aktualisiert",position:"top"}),o("updated"))}catch{d.notify({type:"negative",message:"Fehler beim Aktualisieren"})}};return le(()=>e.goal,l=>{g.value=l.current_amount}),{currentAmount:g,progress:n,progressColor:h,remainingAmount:s,daysRemaining:p,dailySaving:b,motivationMessage:i,formatDate:y,formatNumber:f,updateCurrentAmount:x}}}),G=e=>(Y("data-v-5a2f22bd"),e=e(),H(),e),Bt={class:"text-h5 text-weight-bold text-dark"},It={key:0,class:"text-caption text-grey-7 q-mt-xs"},zt={class:"row justify-center q-mb-lg"},Tt={class:"relative-position",style:{width:"140px",height:"140px"}},Zt={class:"text-center"},Pt={class:"text-h5 text-weight-bold text-primary"},Et=G(()=>t("div",{class:"text-caption text-grey-7"},"erreicht",-1)),jt={class:"row justify-between items-center q-mb-lg"},Mt={class:"text-center"},Ut=G(()=>t("div",{class:"text-caption text-grey-7"},"Gespart",-1)),Lt={class:"text-h4 text-weight-bold text-primary"},Ot={class:"text-center"},Kt=G(()=>t("div",{class:"text-caption text-grey-7"},"Ziel",-1)),Jt={class:"text-h4 text-weight-bold text-dark"},Rt={class:"row items-center"},Wt=G(()=>t("div",{class:"col"},[t("div",{class:"text-caption text-weight-medium text-dark"}," Aktuellen Betrag anpassen ")],-1)),Yt={class:"col-auto"},Ht=G(()=>t("span",{class:"text-caption text-grey-7"},"â‚¬",-1)),Xt={class:"row q-col-gutter-sm q-mb-lg"},ea={class:"col-6"},ta=G(()=>t("div",{class:"text-caption text-weight-medium text-dark"},"Ziel-Datum",-1)),aa={class:"text-caption text-grey-7"},oa={class:"text-caption text-primary text-weight-medium"},sa={class:"col-6"},la=G(()=>t("div",{class:"text-caption text-weight-medium text-dark"},"TÃ¤glich sparen",-1)),ra={class:"text-caption text-primary text-weight-medium"},na=G(()=>t("div",{class:"text-caption text-grey-7"},"fÃ¼r Ziel",-1)),ia={key:0,class:"row items-center justify-center q-mb-lg"},ca=G(()=>t("div",{class:"text-caption text-grey-7"},"Kategorie:",-1)),da=G(()=>t("div",{class:"text-caption"},"Noch zu sparen",-1)),ua={class:"text-h5 text-weight-bold"},ma={class:"text-caption"};function ga(e,o,d,g,n,h){return _(),N(w,{class:"details-card bg-surface"},{default:r(()=>[a(k,{class:"text-center q-pb-none"},{default:r(()=>[t("div",Bt,m(e.goal.title),1),e.goal.description?(_(),A("div",It,m(e.goal.description),1)):F("",!0)]),_:1}),a(k,{class:"q-pt-md"},{default:r(()=>[t("div",zt,[t("div",Tt,[a(Ft,{"show-value":"",value:e.progress,size:"140px",thickness:.22,color:e.progressColor,"track-color":e.$q.dark.isActive?"grey-8":"grey-3",class:"q-mb-md"},{default:r(()=>[t("div",Zt,[t("div",Pt,m(e.progress.toFixed(1))+"% ",1),Et])]),_:1},8,["value","color","track-color"])])]),t("div",jt,[t("div",Mt,[Ut,t("div",Lt," â‚¬"+m(e.formatNumber(e.goal.current_amount)),1)]),a(q,{name:"arrow_forward",size:"sm",color:e.$q.dark.isActive?"grey-6":"grey-5"},null,8,["color"]),t("div",Ot,[Kt,t("div",Jt," â‚¬"+m(e.formatNumber(e.goal.target_amount)),1)])]),a(w,{flat:"",class:"bg-edit-card q-mb-lg"},{default:r(()=>[a(k,{class:"q-pa-md"},{default:r(()=>[t("div",Rt,[Wt,t("div",Yt,[a(z,{modelValue:e.currentAmount,"onUpdate:modelValue":[o[0]||(o[0]=s=>e.currentAmount=s),e.updateCurrentAmount],type:"number",dense:"",outlined:"",style:{width:"120px"},class:"amount-input",dark:e.$q.dark.isActive},{prepend:r(()=>[Ht]),_:1},8,["modelValue","onUpdate:modelValue","dark"])])])]),_:1})]),_:1}),t("div",Xt,[t("div",ea,[a(w,{flat:"",class:"bg-detail-card"},{default:r(()=>[a(k,{class:"q-pa-md text-center"},{default:r(()=>[a(q,{name:"event",size:"sm",color:"primary",class:"q-mb-xs"}),ta,t("div",aa,m(e.formatDate(e.goal.target_date)),1),t("div",oa,m(e.daysRemaining)+" Tage ",1)]),_:1})]),_:1})]),t("div",sa,[a(w,{flat:"",class:"bg-detail-card"},{default:r(()=>[a(k,{class:"q-pa-md text-center"},{default:r(()=>[a(q,{name:"savings",size:"sm",color:"primary",class:"q-mb-xs"}),la,t("div",ra," â‚¬"+m(e.dailySaving),1),na]),_:1})]),_:1})])]),e.goal.category_name?(_(),A("div",ia,[a(q,{name:"category",size:"sm",color:e.$q.dark.isActive?"grey-5":"grey-6",class:"q-mr-sm"},null,8,["color"]),ca,a(E,{label:e.goal.category_name,color:"accent",class:"q-ml-sm text-caption"},null,8,["label"])])):F("",!0),a(w,{flat:"",class:"bg-primary text-white q-mb-md"},{default:r(()=>[a(k,{class:"text-center q-py-sm"},{default:r(()=>[da,t("div",ua,"â‚¬"+m(e.formatNumber(e.remainingAmount)),1)]),_:1})]),_:1}),e.progress<100?(_(),N(w,{key:1,flat:"",class:"bg-motivation text-dark"},{default:r(()=>[a(k,{class:"text-center q-py-sm"},{default:r(()=>[t("div",ma,m(e.motivationMessage),1)]),_:1})]),_:1})):F("",!0)]),_:1}),a(ie,{align:"center",class:"q-pa-md"},{default:r(()=>[X(a(C,{flat:"",label:"SchlieÃŸen",color:"primary",class:"close-button"},null,512),[[te]])]),_:1})]),_:1})}const va=M(Qt,[["render",ga],["__scopeId","data-v-5a2f22bd"]]),fa=U({name:"GoalsView",components:{GoalCard:ct,GoalCreator:Gt,GoalDetails:va},setup(){const e=ee(),o=D([]),d=D(!0),g=D("active"),n=D(!1),h=D(!1),s=D(!1),p=D(null),b=D(null),i=D(null),y=D(null),f=()=>{const u=Be.getToken();if(!u)return null;try{const S=Ie(u);return(S==null?void 0:S.id)??null}catch(S){return console.error("Invalid token while resolving user id:",S),null}},x=u=>({...u,target_amount:Number(u.target_amount)||0,current_amount:Number(u.current_amount)||0,progress_percentage:Number(u.progress_percentage)||0,target_date:u.target_date?String(u.target_date).split("T")[0]:null,status:u.status||"in_progress"}),l=()=>{e.dark.set(!e.dark.isActive)},v=c(()=>{const u=o.value.filter(Z=>Z.status==="in_progress").length,S=o.value.filter(Z=>Z.status==="completed").length,he=o.value.filter(Z=>Z.status==="overdue").length;return{active:u,completed:S,overdue:he}}),$=c(()=>{switch(g.value){case"active":return o.value.filter(u=>u.status!=="completed");case"completed":return o.value.filter(u=>u.status==="completed");case"overdue":return o.value.filter(u=>u.status==="overdue");default:return o.value}}),B=c(()=>{switch(g.value){case"active":return"Noch keine Ziele";case"completed":return"Keine erreichten Ziele";case"overdue":return"Keine Ã¼berfÃ¤lligen Ziele";default:return"Keine Ziele gefunden"}}),I=c(()=>{switch(g.value){case"active":return"Beginne deine Sparreise, indem du dein erstes Ziel erstellst.";case"completed":return"Du hast noch keine Ziele erfolgreich abgeschlossen.";case"overdue":return"GlÃ¼ckwunsch! Alle Ziele sind aktuell im Zeitplan.";default:return"Keine Ziele in dieser Kategorie vorhanden."}}),Q=async()=>{if(!y.value){o.value=[],d.value=!1;return}try{d.value=!0;const u=await fetch(`http://localhost:3000/api/goals/progress/${y.value}`);if(!u.ok)throw new Error(`Failed to fetch goals: ${u.status}`);const S=await u.json();o.value=Array.isArray(S)?S.map(x):[]}catch(u){console.error("Error fetching goals:",u),e.notify({type:"negative",message:"Fehler beim Laden der Ziele",position:"top"})}finally{d.value=!1}},me=u=>{p.value=u,h.value=!0},ge=u=>{b.value=u,n.value=!0},ve=u=>{i.value=u,s.value=!0},fe=async()=>{try{(await fetch(`http://localhost:3000/api/goals/${i.value.id}`,{method:"DELETE"})).ok&&(e.notify({type:"positive",message:"Ziel erfolgreich gelÃ¶scht",position:"top"}),Q())}catch{e.notify({type:"negative",message:"Fehler beim LÃ¶schen des Ziels",position:"top"})}finally{s.value=!1,i.value=null}},pe=()=>{ae(),Q(),e.notify({type:"positive",message:b.value?"Ziel aktualisiert":"Ziel erstellt",position:"top"})},ae=()=>{n.value=!1,b.value=null};return Ne(()=>{if(y.value=f(),!y.value){e.notify({type:"negative",message:"Session ungÃ¼ltig. Bitte erneut einloggen.",position:"top"}),d.value=!1;return}Q()}),{goals:o,loading:d,activeTab:g,showCreateDialog:n,showDetailsDialog:h,showDeleteDialog:s,selectedGoal:p,editingGoal:b,deletingGoal:i,userId:y,stats:v,filteredGoals:$,emptyStateMessage:B,emptyStateDescription:I,openGoalDetails:me,editGoal:ge,confirmDeleteGoal:ve,deleteGoal:fe,handleGoalSaved:pe,closeDialogs:ae,fetchGoals:Q,toggleDarkMode:l}}}),pa={class:"goals-view"},ha={class:"dark-mode-toggle"},ba={class:"header-section q-mb-xl"},ya={class:"row items-center justify-between q-mb-lg"},_a=t("div",{class:"col"},[t("div",{class:"header-content"},[t("h1",{class:"text-h3 text-weight-bold text-dark q-mb-xs"}," ðŸŽ¯ Sparziele "),t("p",{class:"text-subtitle1 text-grey-7"}," Verwalte und verfolge deine finanziellen Ziele ")])],-1),$a={class:"col-auto"},ka={class:"row q-col-gutter-md q-mb-lg"},wa={class:"col-12 col-sm-4"},xa={class:"stat-icon bg-primary"},qa={class:"text-h2 text-weight-bold text-primary"},Da=t("div",{class:"text-subtitle2 text-grey-7"},"Aktive Ziele",-1),Sa={class:"col-12 col-sm-4"},Ca={class:"stat-icon bg-positive"},Aa={class:"text-h2 text-weight-bold text-positive"},Ga=t("div",{class:"text-subtitle2 text-grey-7"},"Erreicht",-1),Va={class:"col-12 col-sm-4"},Na={class:"stat-icon bg-negative"},Fa={class:"text-h2 text-weight-bold text-negative"},Qa=t("div",{class:"text-subtitle2 text-grey-7"},"ÃœberfÃ¤llig",-1),Ba={class:"content-section"},Ia={key:0,class:"loading-section text-center q-py-xl"},za=t("div",{class:"text-h6 text-grey-7 q-mt-md"},"Lade Ziele...",-1),Ta={key:1,class:"goals-grid"},Za={class:"row q-col-gutter-lg"},Pa={class:"empty-icon"},Ea={class:"text-h5 text-weight-medium text-grey-7 q-mb-md"},ja={class:"text-grey-6 q-mb-xl"},Ma={class:"warning-icon"},Ua=t("div",{class:"text-h6 text-weight-bold text-dark q-mb-sm"},"Ziel lÃ¶schen",-1),La={class:"text-grey-7"},Oa=t("br",null,null,-1);function Ka(e,o,d,g,n,h){const s=K("GoalCard"),p=K("GoalCreator"),b=K("GoalDetails");return _(),N(ze,{class:"q-pa-lg bg-page responsive-page-padding"},{default:r(()=>[t("div",pa,[t("div",ha,[a(C,{round:"",color:e.$q.dark.isActive?"grey-9":"yellow-9",icon:e.$q.dark.isActive?"dark_mode":"light_mode",class:"toggle-btn",onClick:e.toggleDarkMode,size:"lg"},null,8,["color","icon","onClick"])]),t("div",ba,[t("div",ya,[_a,t("div",$a,[a(C,{label:"Neues Ziel",icon:"add",color:"primary",class:"create-button",onClick:o[0]||(o[0]=i=>e.showCreateDialog=!0)})])]),t("div",ka,[t("div",wa,[a(w,{class:"stat-card active-stat"},{default:r(()=>[a(k,{class:"text-center q-pa-lg"},{default:r(()=>[t("div",xa,[a(q,{name:"trending_up",color:"white"})]),t("div",qa,m(e.stats.active),1),Da]),_:1})]),_:1})]),t("div",Sa,[a(w,{class:"stat-card completed-stat"},{default:r(()=>[a(k,{class:"text-center q-pa-lg"},{default:r(()=>[t("div",Ca,[a(q,{name:"check_circle",color:"white"})]),t("div",Aa,m(e.stats.completed),1),Ga]),_:1})]),_:1})]),t("div",Va,[a(w,{class:"stat-card overdue-stat"},{default:r(()=>[a(k,{class:"text-center q-pa-lg"},{default:r(()=>[t("div",Na,[a(q,{name:"warning",color:"white"})]),t("div",Fa,m(e.stats.overdue),1),Qa]),_:1})]),_:1})])]),a(w,{class:"filter-card"},{default:r(()=>[a(Fe,{modelValue:e.activeTab,"onUpdate:modelValue":o[1]||(o[1]=i=>e.activeTab=i),class:"filter-tabs text-primary","indicator-color":"primary",align:"justify"},{default:r(()=>[a(R,{name:"active",icon:"schedule",label:`Aktiv (${e.stats.active+e.stats.overdue})`,class:"text-weight-medium"},null,8,["label"]),a(R,{name:"completed",icon:"check_circle",label:`Erreicht (${e.stats.completed})`,class:"text-weight-medium"},null,8,["label"]),a(R,{name:"overdue",icon:"warning",label:`ÃœberfÃ¤llig (${e.stats.overdue})`,class:"text-weight-medium"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1})]),t("div",Ba,[e.loading?(_(),A("div",Ia,[a(Qe,{size:"50px",color:"primary",class:"loading-spinner"}),za])):e.filteredGoals.length>0?(_(),A("div",Ta,[t("div",Za,[(_(!0),A(re,null,ne(e.filteredGoals,i=>(_(),A("div",{key:i.id,class:"col-12 col-md-6 col-lg-4"},[a(s,{goal:i,onClick:y=>e.openGoalDetails(i),onEdit:y=>e.editGoal(i),onDelete:y=>e.confirmDeleteGoal(i)},null,8,["goal","onClick","onEdit","onDelete"])]))),128))])])):(_(),N(w,{key:2,class:"empty-state text-center"},{default:r(()=>[a(k,{class:"q-pa-xl"},{default:r(()=>[t("div",Pa,[a(q,{name:"savings"})]),t("div",Ea,m(e.emptyStateMessage),1),t("p",ja,m(e.emptyStateDescription),1),e.activeTab==="active"?(_(),N(C,{key:0,label:"Erstes Ziel erstellen",color:"primary",icon:"add",class:"empty-state-button",onClick:o[2]||(o[2]=i=>e.showCreateDialog=!0)})):F("",!0)]),_:1})]),_:1}))]),a(Me,{position:"bottom-right",offset:[18,18]},{default:r(()=>[a(C,{fab:"",icon:"add",color:"primary",class:"fab-button",onClick:o[3]||(o[3]=i=>e.showCreateDialog=!0)})]),_:1}),a(J,{modelValue:e.showCreateDialog,"onUpdate:modelValue":o[4]||(o[4]=i=>e.showCreateDialog=i),persistent:""},{default:r(()=>[a(p,{userId:e.userId,editGoal:e.editingGoal,onSaved:e.handleGoalSaved,onCancel:e.closeDialogs},null,8,["userId","editGoal","onSaved","onCancel"])]),_:1},8,["modelValue"]),a(J,{modelValue:e.showDetailsDialog,"onUpdate:modelValue":o[6]||(o[6]=i=>e.showDetailsDialog=i)},{default:r(()=>[a(b,{goal:e.selectedGoal,onClose:o[5]||(o[5]=i=>e.showDetailsDialog=!1),onUpdated:e.fetchGoals},null,8,["goal","onUpdated"])]),_:1},8,["modelValue"]),a(J,{modelValue:e.showDeleteDialog,"onUpdate:modelValue":o[7]||(o[7]=i=>e.showDeleteDialog=i)},{default:r(()=>[a(w,{class:"delete-dialog"},{default:r(()=>[a(k,{class:"text-center q-pa-xl"},{default:r(()=>{var i;return[t("div",Ma,[a(q,{name:"warning"})]),Ua,t("p",La,[T(" Bist du sicher, dass du das Ziel"),Oa,t("strong",null,'"'+m((i=e.deletingGoal)==null?void 0:i.title)+'"',1),T(" lÃ¶schen mÃ¶chtest? ")])]}),_:1}),a(ie,{align:"center",class:"q-pb-xl"},{default:r(()=>[X(a(C,{flat:"",label:"Abbrechen",color:"grey-6",class:"cancel-button"},null,512),[[te]]),a(C,{label:"LÃ¶schen",color:"negative",onClick:e.deleteGoal,class:"delete-confirm-button"},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})}const so=M(fa,[["render",Ka]]);export{so as default};
